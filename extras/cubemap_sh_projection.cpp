#include "cubemap_sh_projection.h"
#include <macros.h>
#include <vk_mem_alloc.h>
#include <profiler.h>
#include <glm.hpp>
#include <logger.h>

#define IRRADIANCE_CUBEMAP_SIZE 128
#define IRRADIANCE_WORK_GROUP_SIZE 8
#define SH_INTERMEDIATE_SIZE (IRRADIANCE_CUBEMAP_SIZE / IRRADIANCE_WORK_GROUP_SIZE)

namespace dw
{
// -----------------------------------------------------------------------------------------------------------------------------------

#if defined(DWSF_VULKAN)
static const unsigned int kSH_PROJECTION_SPIRV_size            = 12604;
static const unsigned int kSH_PROJECTION_SPIRV_data[12604 / 4] = {
    0x07230203,
    0x00010500,
    0x0008000a,
    0x00000224,
    0x00000000,
    0x00020011,
    0x00000001,
    0x0006000b,
    0x00000001,
    0x4c534c47,
    0x6474732e,
    0x3035342e,
    0x00000000,
    0x0003000e,
    0x00000000,
    0x00000001,
    0x000c000f,
    0x00000005,
    0x00000004,
    0x6e69616d,
    0x00000000,
    0x00000092,
    0x0000013c,
    0x0000013f,
    0x0000014e,
    0x00000165,
    0x00000175,
    0x00000215,
    0x00060010,
    0x00000004,
    0x00000011,
    0x00000008,
    0x00000008,
    0x00000001,
    0x00030003,
    0x00000002,
    0x000001c2,
    0x00040005,
    0x00000004,
    0x6e69616d,
    0x00000000,
    0x00080005,
    0x0000000b,
    0x61657261,
    0x746e695f,
    0x61726765,
    0x3166286c,
    0x3b31663b,
    0x00000000,
    0x00030005,
    0x00000009,
    0x00000078,
    0x00030005,
    0x0000000a,
    0x00000079,
    0x00060005,
    0x0000000f,
    0x656c6e75,
    0x66287072,
    0x31663b31,
    0x0000003b,
    0x00030005,
    0x0000000d,
    0x006c6176,
    0x00040005,
    0x0000000e,
    0x5f78616d,
    0x006c6176,
    0x00030005,
    0x00000016,
    0x00394853,
    0x00040006,
    0x00000016,
    0x00000000,
    0x00000063,
    0x000c0005,
    0x0000001b,
    0x6a6f7270,
    0x5f746365,
    0x6f746e6f,
    0x3968735f,
    0x33667628,
    0x7274733b,
    0x2d746375,
    0x2d394853,
    0x395b3166,
    0x003b315d,
    0x00030005,
    0x00000019,
    0x00726964,
    0x00030005,
    0x0000001a,
    0x00006873,
    0x000a0005,
    0x00000021,
    0x636c6163,
    0x74616c75,
    0x6f735f65,
    0x5f64696c,
    0x6c676e61,
    0x31752865,
    0x3b31753b,
    0x00000000,
    0x00030005,
    0x0000001f,
    0x00000078,
    0x00030005,
    0x00000020,
    0x00000079,
    0x000a0005,
    0x00000027,
    0x636c6163,
    0x74616c75,
    0x69645f65,
    0x74636572,
    0x286e6f69,
    0x753b3175,
    0x31753b31,
    0x0000003b,
    0x00040005,
    0x00000024,
    0x65636166,
    0x00000000,
    0x00040005,
    0x00000025,
    0x65636166,
    0x0000785f,
    0x00040005,
    0x00000026,
    0x65636166,
    0x0000795f,
    0x00030005,
    0x0000008d,
    0x00000073,
    0x00060005,
    0x00000090,
    0x68737550,
    0x736e6f43,
    0x746e6174,
    0x00000073,
    0x00050006,
    0x00000090,
    0x00000000,
    0x657a6973,
    0x00000000,
    0x00060005,
    0x00000092,
    0x68737570,
    0x6e6f635f,
    0x6e617473,
    0x00007374,
    0x00040005,
    0x00000093,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x00000094,
    0x61726170,
    0x0000006d,
    0x00030005,
    0x0000009c,
    0x00000074,
    0x00040005,
    0x0000009f,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000a0,
    0x61726170,
    0x0000006d,
    0x00060005,
    0x000000a6,
    0x666c6168,
    0x7865745f,
    0x735f6c65,
    0x00657a69,
    0x00030005,
    0x000000aa,
    0x00003078,
    0x00030005,
    0x000000ae,
    0x00003079,
    0x00030005,
    0x000000b2,
    0x00003178,
    0x00030005,
    0x000000b6,
    0x00003179,
    0x00040005,
    0x000000ba,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000bc,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000bf,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000c1,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000c5,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000c7,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000cb,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000cd,
    0x61726170,
    0x0000006d,
    0x00030005,
    0x000000d3,
    0x00000073,
    0x00040005,
    0x000000d6,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000d7,
    0x61726170,
    0x0000006d,
    0x00030005,
    0x000000dd,
    0x00000074,
    0x00040005,
    0x000000e0,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x000000e1,
    0x61726170,
    0x0000006d,
    0x00030005,
    0x000000ef,
    0x00000078,
    0x00030005,
    0x000000f1,
    0x00000079,
    0x00030005,
    0x000000f4,
    0x0000007a,
    0x00040005,
    0x0000010d,
    0x5f766e69,
    0x006e656c,
    0x00030005,
    0x0000011b,
    0x00000064,
    0x00030005,
    0x0000012c,
    0x00000069,
    0x00050005,
    0x00000137,
    0x43394853,
    0x726f6c6f,
    0x00000000,
    0x00040006,
    0x00000137,
    0x00000000,
    0x00000063,
    0x00050005,
    0x0000013c,
    0x68735f67,
    0x656f635f,
    0x00736666,
    0x00080005,
    0x0000013f,
    0x4c5f6c67,
    0x6c61636f,
    0x6f766e49,
    0x69746163,
    0x44496e6f,
    0x00000000,
    0x00030005,
    0x0000014d,
    0x00726964,
    0x00080005,
    0x0000014e,
    0x475f6c67,
    0x61626f6c,
    0x766e496c,
    0x7461636f,
    0x496e6f69,
    0x00000044,
    0x00040005,
    0x0000014f,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x00000152,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x00000155,
    0x61726170,
    0x0000006d,
    0x00050005,
    0x00000159,
    0x696c6f73,
    0x6e615f64,
    0x00656c67,
    0x00040005,
    0x0000015a,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x0000015d,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x00000161,
    0x65786574,
    0x0000006c,
    0x00050005,
    0x00000165,
    0x75435f73,
    0x616d6562,
    0x00000070,
    0x00040005,
    0x0000016b,
    0x69736162,
    0x00000073,
    0x00040005,
    0x0000016c,
    0x61726170,
    0x0000006d,
    0x00040005,
    0x0000016e,
    0x61726170,
    0x0000006d,
    0x00050005,
    0x00000175,
    0x65775f67,
    0x74686769,
    0x00000073,
    0x00030005,
    0x0000017d,
    0x00000069,
    0x00050005,
    0x0000019c,
    0x72616873,
    0x695f6465,
    0x00007864,
    0x00050005,
    0x000001af,
    0x66656f63,
    0x7864695f,
    0x00000000,
    0x00050005,
    0x000001d3,
    0x72616873,
    0x695f6465,
    0x00007864,
    0x00050005,
    0x000001e2,
    0x66656f63,
    0x7864695f,
    0x00000000,
    0x00050005,
    0x000001f7,
    0x66656f63,
    0x7864695f,
    0x00000000,
    0x00030005,
    0x00000201,
    0x00000070,
    0x00060005,
    0x00000215,
    0x6e495f69,
    0x6d726574,
    0x61696465,
    0x00006574,
    0x00050048,
    0x00000090,
    0x00000000,
    0x00000023,
    0x00000000,
    0x00030047,
    0x00000090,
    0x00000002,
    0x00040047,
    0x0000013f,
    0x0000000b,
    0x0000001b,
    0x00040047,
    0x0000014e,
    0x0000000b,
    0x0000001c,
    0x00040047,
    0x00000165,
    0x00000022,
    0x00000000,
    0x00040047,
    0x00000165,
    0x00000021,
    0x00000001,
    0x00040047,
    0x00000215,
    0x00000022,
    0x00000000,
    0x00040047,
    0x00000215,
    0x00000021,
    0x00000000,
    0x00040047,
    0x00000223,
    0x0000000b,
    0x00000019,
    0x00020013,
    0x00000002,
    0x00030021,
    0x00000003,
    0x00000002,
    0x00030016,
    0x00000006,
    0x00000020,
    0x00040020,
    0x00000007,
    0x00000007,
    0x00000006,
    0x00050021,
    0x00000008,
    0x00000006,
    0x00000007,
    0x00000007,
    0x00040017,
    0x00000011,
    0x00000006,
    0x00000003,
    0x00040020,
    0x00000012,
    0x00000007,
    0x00000011,
    0x00040015,
    0x00000013,
    0x00000020,
    0x00000000,
    0x0004002b,
    0x00000013,
    0x00000014,
    0x00000009,
    0x0004001c,
    0x00000015,
    0x00000006,
    0x00000014,
    0x0003001e,
    0x00000016,
    0x00000015,
    0x00040020,
    0x00000017,
    0x00000007,
    0x00000016,
    0x00050021,
    0x00000018,
    0x00000002,
    0x00000012,
    0x00000017,
    0x00040020,
    0x0000001d,
    0x00000007,
    0x00000013,
    0x00050021,
    0x0000001e,
    0x00000006,
    0x0000001d,
    0x0000001d,
    0x00060021,
    0x00000023,
    0x00000011,
    0x0000001d,
    0x0000001d,
    0x0000001d,
    0x0004002b,
    0x00000006,
    0x00000033,
    0x3f800000,
    0x0004002b,
    0x00000006,
    0x0000003a,
    0x3f000000,
    0x00040015,
    0x00000040,
    0x00000020,
    0x00000001,
    0x0004002b,
    0x00000040,
    0x00000041,
    0x00000000,
    0x0004002b,
    0x00000006,
    0x00000042,
    0x3e906ec1,
    0x0004002b,
    0x00000040,
    0x00000044,
    0x00000001,
    0x0004002b,
    0x00000006,
    0x00000045,
    0xbefa2a2c,
    0x0004002b,
    0x00000013,
    0x00000046,
    0x00000001,
    0x0004002b,
    0x00000040,
    0x0000004b,
    0x00000002,
    0x0004002b,
    0x00000006,
    0x0000004c,
    0x3efa2a2c,
    0x0004002b,
    0x00000013,
    0x0000004d,
    0x00000002,
    0x0004002b,
    0x00000040,
    0x00000052,
    0x00000003,
    0x0004002b,
    0x00000013,
    0x00000053,
    0x00000000,
    0x0004002b,
    0x00000040,
    0x00000058,
    0x00000004,
    0x0004002b,
    0x00000006,
    0x00000059,
    0x3f8bd89d,
    0x0004002b,
    0x00000040,
    0x00000061,
    0x00000005,
    0x0004002b,
    0x00000006,
    0x00000062,
    0xbf8bd89d,
    0x0004002b,
    0x00000040,
    0x0000006a,
    0x00000006,
    0x0004002b,
    0x00000006,
    0x0000006b,
    0x3ea17b0f,
    0x0004002b,
    0x00000006,
    0x0000006c,
    0x40400000,
    0x0004002b,
    0x00000040,
    0x00000076,
    0x00000007,
    0x0004002b,
    0x00000040,
    0x0000007e,
    0x00000008,
    0x0004002b,
    0x00000006,
    0x0000007f,
    0x3f0bd89d,
    0x0003001e,
    0x00000090,
    0x00000006,
    0x00040020,
    0x00000091,
    0x00000009,
    0x00000090,
    0x0004003b,
    0x00000091,
    0x00000092,
    0x00000009,
    0x00040020,
    0x00000095,
    0x00000009,
    0x00000006,
    0x0004002b,
    0x00000006,
    0x00000099,
    0x40000000,
    0x0004002b,
    0x00000006,
    0x000000fa,
    0xbf800000,
    0x00040020,
    0x0000012b,
    0x00000007,
    0x00000040,
    0x0004002b,
    0x00000040,
    0x00000133,
    0x00000009,
    0x00020014,
    0x00000134,
    0x0004001c,
    0x00000136,
    0x00000011,
    0x00000014,
    0x0003001e,
    0x00000137,
    0x00000136,
    0x0004002b,
    0x00000013,
    0x00000138,
    0x00000008,
    0x0004001c,
    0x00000139,
    0x00000137,
    0x00000138,
    0x0004001c,
    0x0000013a,
    0x00000139,
    0x00000138,
    0x00040020,
    0x0000013b,
    0x00000004,
    0x0000013a,
    0x0004003b,
    0x0000013b,
    0x0000013c,
    0x00000004,
    0x00040017,
    0x0000013d,
    0x00000013,
    0x00000003,
    0x00040020,
    0x0000013e,
    0x00000001,
    0x0000013d,
    0x0004003b,
    0x0000013e,
    0x0000013f,
    0x00000001,
    0x00040020,
    0x00000140,
    0x00000001,
    0x00000013,
    0x0004002b,
    0x00000006,
    0x00000146,
    0x00000000,
    0x0006002c,
    0x00000011,
    0x00000147,
    0x00000146,
    0x00000146,
    0x00000146,
    0x00040020,
    0x00000148,
    0x00000004,
    0x00000011,
    0x0004002b,
    0x00000013,
    0x0000014c,
    0x00000108,
    0x0004003b,
    0x0000013e,
    0x0000014e,
    0x00000001,
    0x00090019,
    0x00000162,
    0x00000006,
    0x00000003,
    0x00000000,
    0x00000000,
    0x00000000,
    0x00000001,
    0x00000000,
    0x0003001b,
    0x00000163,
    0x00000162,
    0x00040020,
    0x00000164,
    0x00000000,
    0x00000163,
    0x0004003b,
    0x00000164,
    0x00000165,
    0x00000000,
    0x00040017,
    0x00000168,
    0x00000006,
    0x00000004,
    0x0004001c,
    0x00000172,
    0x00000006,
    0x00000138,
    0x0004001c,
    0x00000173,
    0x00000172,
    0x00000138,
    0x00040020,
    0x00000174,
    0x00000004,
    0x00000173,
    0x0004003b,
    0x00000174,
    0x00000175,
    0x00000004,
    0x00040020,
    0x0000017b,
    0x00000004,
    0x00000006,
    0x00040017,
    0x000001ff,
    0x00000040,
    0x00000003,
    0x00040020,
    0x00000200,
    0x00000007,
    0x000001ff,
    0x0004002b,
    0x00000040,
    0x00000202,
    0x00000010,
    0x00090019,
    0x00000213,
    0x00000006,
    0x00000001,
    0x00000000,
    0x00000001,
    0x00000000,
    0x00000002,
    0x00000001,
    0x00040020,
    0x00000214,
    0x00000000,
    0x00000213,
    0x0004003b,
    0x00000214,
    0x00000215,
    0x00000000,
    0x0006002c,
    0x0000013d,
    0x00000223,
    0x00000138,
    0x00000138,
    0x00000046,
    0x00050036,
    0x00000002,
    0x00000004,
    0x00000000,
    0x00000003,
    0x000200f8,
    0x00000005,
    0x0004003b,
    0x0000012b,
    0x0000012c,
    0x00000007,
    0x0004003b,
    0x00000012,
    0x0000014d,
    0x00000007,
    0x0004003b,
    0x0000001d,
    0x0000014f,
    0x00000007,
    0x0004003b,
    0x0000001d,
    0x00000152,
    0x00000007,
    0x0004003b,
    0x0000001d,
    0x00000155,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x00000159,
    0x00000007,
    0x0004003b,
    0x0000001d,
    0x0000015a,
    0x00000007,
    0x0004003b,
    0x0000001d,
    0x0000015d,
    0x00000007,
    0x0004003b,
    0x00000012,
    0x00000161,
    0x00000007,
    0x0004003b,
    0x00000017,
    0x0000016b,
    0x00000007,
    0x0004003b,
    0x00000012,
    0x0000016c,
    0x00000007,
    0x0004003b,
    0x00000017,
    0x0000016e,
    0x00000007,
    0x0004003b,
    0x0000012b,
    0x0000017d,
    0x00000007,
    0x0004003b,
    0x0000012b,
    0x0000019c,
    0x00000007,
    0x0004003b,
    0x0000012b,
    0x000001af,
    0x00000007,
    0x0004003b,
    0x0000012b,
    0x000001d3,
    0x00000007,
    0x0004003b,
    0x0000012b,
    0x000001e2,
    0x00000007,
    0x0004003b,
    0x0000012b,
    0x000001f7,
    0x00000007,
    0x0004003b,
    0x00000200,
    0x00000201,
    0x00000007,
    0x0003003e,
    0x0000012c,
    0x00000041,
    0x000200f9,
    0x0000012d,
    0x000200f8,
    0x0000012d,
    0x000400f6,
    0x0000012f,
    0x00000130,
    0x00000000,
    0x000200f9,
    0x00000131,
    0x000200f8,
    0x00000131,
    0x0004003d,
    0x00000040,
    0x00000132,
    0x0000012c,
    0x000500b1,
    0x00000134,
    0x00000135,
    0x00000132,
    0x00000133,
    0x000400fa,
    0x00000135,
    0x0000012e,
    0x0000012f,
    0x000200f8,
    0x0000012e,
    0x00050041,
    0x00000140,
    0x00000141,
    0x0000013f,
    0x00000053,
    0x0004003d,
    0x00000013,
    0x00000142,
    0x00000141,
    0x00050041,
    0x00000140,
    0x00000143,
    0x0000013f,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x00000144,
    0x00000143,
    0x0004003d,
    0x00000040,
    0x00000145,
    0x0000012c,
    0x00080041,
    0x00000148,
    0x00000149,
    0x0000013c,
    0x00000142,
    0x00000144,
    0x00000041,
    0x00000145,
    0x0003003e,
    0x00000149,
    0x00000147,
    0x000200f9,
    0x00000130,
    0x000200f8,
    0x00000130,
    0x0004003d,
    0x00000040,
    0x0000014a,
    0x0000012c,
    0x00050080,
    0x00000040,
    0x0000014b,
    0x0000014a,
    0x00000044,
    0x0003003e,
    0x0000012c,
    0x0000014b,
    0x000200f9,
    0x0000012d,
    0x000200f8,
    0x0000012f,
    0x000400e0,
    0x0000004d,
    0x0000004d,
    0x0000014c,
    0x00050041,
    0x00000140,
    0x00000150,
    0x0000014e,
    0x0000004d,
    0x0004003d,
    0x00000013,
    0x00000151,
    0x00000150,
    0x0003003e,
    0x0000014f,
    0x00000151,
    0x00050041,
    0x00000140,
    0x00000153,
    0x0000014e,
    0x00000053,
    0x0004003d,
    0x00000013,
    0x00000154,
    0x00000153,
    0x0003003e,
    0x00000152,
    0x00000154,
    0x00050041,
    0x00000140,
    0x00000156,
    0x0000014e,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x00000157,
    0x00000156,
    0x0003003e,
    0x00000155,
    0x00000157,
    0x00070039,
    0x00000011,
    0x00000158,
    0x00000027,
    0x0000014f,
    0x00000152,
    0x00000155,
    0x0003003e,
    0x0000014d,
    0x00000158,
    0x00050041,
    0x00000140,
    0x0000015b,
    0x0000014e,
    0x00000053,
    0x0004003d,
    0x00000013,
    0x0000015c,
    0x0000015b,
    0x0003003e,
    0x0000015a,
    0x0000015c,
    0x00050041,
    0x00000140,
    0x0000015e,
    0x0000014e,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x0000015f,
    0x0000015e,
    0x0003003e,
    0x0000015d,
    0x0000015f,
    0x00060039,
    0x00000006,
    0x00000160,
    0x00000021,
    0x0000015a,
    0x0000015d,
    0x0003003e,
    0x00000159,
    0x00000160,
    0x0004003d,
    0x00000163,
    0x00000166,
    0x00000165,
    0x0004003d,
    0x00000011,
    0x00000167,
    0x0000014d,
    0x00070058,
    0x00000168,
    0x00000169,
    0x00000166,
    0x00000167,
    0x00000002,
    0x00000099,
    0x0008004f,
    0x00000011,
    0x0000016a,
    0x00000169,
    0x00000169,
    0x00000000,
    0x00000001,
    0x00000002,
    0x0003003e,
    0x00000161,
    0x0000016a,
    0x0004003d,
    0x00000011,
    0x0000016d,
    0x0000014d,
    0x0003003e,
    0x0000016c,
    0x0000016d,
    0x0004003d,
    0x00000016,
    0x0000016f,
    0x0000016b,
    0x0003003e,
    0x0000016e,
    0x0000016f,
    0x00060039,
    0x00000002,
    0x00000170,
    0x0000001b,
    0x0000016c,
    0x0000016e,
    0x0004003d,
    0x00000016,
    0x00000171,
    0x0000016e,
    0x0003003e,
    0x0000016b,
    0x00000171,
    0x00050041,
    0x00000140,
    0x00000176,
    0x0000013f,
    0x00000053,
    0x0004003d,
    0x00000013,
    0x00000177,
    0x00000176,
    0x00050041,
    0x00000140,
    0x00000178,
    0x0000013f,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x00000179,
    0x00000178,
    0x0004003d,
    0x00000006,
    0x0000017a,
    0x00000159,
    0x00060041,
    0x0000017b,
    0x0000017c,
    0x00000175,
    0x00000177,
    0x00000179,
    0x0003003e,
    0x0000017c,
    0x0000017a,
    0x0003003e,
    0x0000017d,
    0x00000041,
    0x000200f9,
    0x0000017e,
    0x000200f8,
    0x0000017e,
    0x000400f6,
    0x00000180,
    0x00000181,
    0x00000000,
    0x000200f9,
    0x00000182,
    0x000200f8,
    0x00000182,
    0x0004003d,
    0x00000040,
    0x00000183,
    0x0000017d,
    0x000500b1,
    0x00000134,
    0x00000184,
    0x00000183,
    0x00000133,
    0x000400fa,
    0x00000184,
    0x0000017f,
    0x00000180,
    0x000200f8,
    0x0000017f,
    0x00050041,
    0x00000140,
    0x00000185,
    0x0000013f,
    0x00000053,
    0x0004003d,
    0x00000013,
    0x00000186,
    0x00000185,
    0x00050041,
    0x00000140,
    0x00000187,
    0x0000013f,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x00000188,
    0x00000187,
    0x0004003d,
    0x00000040,
    0x00000189,
    0x0000017d,
    0x0004003d,
    0x00000011,
    0x0000018a,
    0x00000161,
    0x0004003d,
    0x00000040,
    0x0000018b,
    0x0000017d,
    0x00060041,
    0x00000007,
    0x0000018c,
    0x0000016b,
    0x00000041,
    0x0000018b,
    0x0004003d,
    0x00000006,
    0x0000018d,
    0x0000018c,
    0x0005008e,
    0x00000011,
    0x0000018e,
    0x0000018a,
    0x0000018d,
    0x0004003d,
    0x00000006,
    0x0000018f,
    0x00000159,
    0x0005008e,
    0x00000011,
    0x00000190,
    0x0000018e,
    0x0000018f,
    0x00080041,
    0x00000148,
    0x00000191,
    0x0000013c,
    0x00000186,
    0x00000188,
    0x00000041,
    0x00000189,
    0x0004003d,
    0x00000011,
    0x00000192,
    0x00000191,
    0x00050081,
    0x00000011,
    0x00000193,
    0x00000192,
    0x00000190,
    0x00080041,
    0x00000148,
    0x00000194,
    0x0000013c,
    0x00000186,
    0x00000188,
    0x00000041,
    0x00000189,
    0x0003003e,
    0x00000194,
    0x00000193,
    0x000200f9,
    0x00000181,
    0x000200f8,
    0x00000181,
    0x0004003d,
    0x00000040,
    0x00000195,
    0x0000017d,
    0x00050080,
    0x00000040,
    0x00000196,
    0x00000195,
    0x00000044,
    0x0003003e,
    0x0000017d,
    0x00000196,
    0x000200f9,
    0x0000017e,
    0x000200f8,
    0x00000180,
    0x000400e0,
    0x0000004d,
    0x0000004d,
    0x0000014c,
    0x00050041,
    0x00000140,
    0x00000197,
    0x0000013f,
    0x00000053,
    0x0004003d,
    0x00000013,
    0x00000198,
    0x00000197,
    0x000500aa,
    0x00000134,
    0x00000199,
    0x00000198,
    0x00000053,
    0x000300f7,
    0x0000019b,
    0x00000000,
    0x000400fa,
    0x00000199,
    0x0000019a,
    0x0000019b,
    0x000200f8,
    0x0000019a,
    0x0003003e,
    0x0000019c,
    0x00000044,
    0x000200f9,
    0x0000019d,
    0x000200f8,
    0x0000019d,
    0x000400f6,
    0x0000019f,
    0x000001a0,
    0x00000000,
    0x000200f9,
    0x000001a1,
    0x000200f8,
    0x000001a1,
    0x0004003d,
    0x00000040,
    0x000001a2,
    0x0000019c,
    0x000500b1,
    0x00000134,
    0x000001a3,
    0x000001a2,
    0x0000007e,
    0x000400fa,
    0x000001a3,
    0x0000019e,
    0x0000019f,
    0x000200f8,
    0x0000019e,
    0x00050041,
    0x00000140,
    0x000001a4,
    0x0000013f,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x000001a5,
    0x000001a4,
    0x0004003d,
    0x00000040,
    0x000001a6,
    0x0000019c,
    0x00050041,
    0x00000140,
    0x000001a7,
    0x0000013f,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x000001a8,
    0x000001a7,
    0x00060041,
    0x0000017b,
    0x000001a9,
    0x00000175,
    0x000001a6,
    0x000001a8,
    0x0004003d,
    0x00000006,
    0x000001aa,
    0x000001a9,
    0x00060041,
    0x0000017b,
    0x000001ab,
    0x00000175,
    0x00000041,
    0x000001a5,
    0x0004003d,
    0x00000006,
    0x000001ac,
    0x000001ab,
    0x00050081,
    0x00000006,
    0x000001ad,
    0x000001ac,
    0x000001aa,
    0x00060041,
    0x0000017b,
    0x000001ae,
    0x00000175,
    0x00000041,
    0x000001a5,
    0x0003003e,
    0x000001ae,
    0x000001ad,
    0x0003003e,
    0x000001af,
    0x00000041,
    0x000200f9,
    0x000001b0,
    0x000200f8,
    0x000001b0,
    0x000400f6,
    0x000001b2,
    0x000001b3,
    0x00000000,
    0x000200f9,
    0x000001b4,
    0x000200f8,
    0x000001b4,
    0x0004003d,
    0x00000040,
    0x000001b5,
    0x000001af,
    0x000500b1,
    0x00000134,
    0x000001b6,
    0x000001b5,
    0x00000133,
    0x000400fa,
    0x000001b6,
    0x000001b1,
    0x000001b2,
    0x000200f8,
    0x000001b1,
    0x00050041,
    0x00000140,
    0x000001b7,
    0x0000013f,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x000001b8,
    0x000001b7,
    0x0004003d,
    0x00000040,
    0x000001b9,
    0x000001af,
    0x0004003d,
    0x00000040,
    0x000001ba,
    0x0000019c,
    0x00050041,
    0x00000140,
    0x000001bb,
    0x0000013f,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x000001bc,
    0x000001bb,
    0x0004003d,
    0x00000040,
    0x000001bd,
    0x000001af,
    0x00080041,
    0x00000148,
    0x000001be,
    0x0000013c,
    0x000001ba,
    0x000001bc,
    0x00000041,
    0x000001bd,
    0x0004003d,
    0x00000011,
    0x000001bf,
    0x000001be,
    0x00080041,
    0x00000148,
    0x000001c0,
    0x0000013c,
    0x00000041,
    0x000001b8,
    0x00000041,
    0x000001b9,
    0x0004003d,
    0x00000011,
    0x000001c1,
    0x000001c0,
    0x00050081,
    0x00000011,
    0x000001c2,
    0x000001c1,
    0x000001bf,
    0x00080041,
    0x00000148,
    0x000001c3,
    0x0000013c,
    0x00000041,
    0x000001b8,
    0x00000041,
    0x000001b9,
    0x0003003e,
    0x000001c3,
    0x000001c2,
    0x000200f9,
    0x000001b3,
    0x000200f8,
    0x000001b3,
    0x0004003d,
    0x00000040,
    0x000001c4,
    0x000001af,
    0x00050080,
    0x00000040,
    0x000001c5,
    0x000001c4,
    0x00000044,
    0x0003003e,
    0x000001af,
    0x000001c5,
    0x000200f9,
    0x000001b0,
    0x000200f8,
    0x000001b2,
    0x000200f9,
    0x000001a0,
    0x000200f8,
    0x000001a0,
    0x0004003d,
    0x00000040,
    0x000001c6,
    0x0000019c,
    0x00050080,
    0x00000040,
    0x000001c7,
    0x000001c6,
    0x00000044,
    0x0003003e,
    0x0000019c,
    0x000001c7,
    0x000200f9,
    0x0000019d,
    0x000200f8,
    0x0000019f,
    0x000200f9,
    0x0000019b,
    0x000200f8,
    0x0000019b,
    0x000400e0,
    0x0000004d,
    0x0000004d,
    0x0000014c,
    0x00050041,
    0x00000140,
    0x000001c8,
    0x0000013f,
    0x00000053,
    0x0004003d,
    0x00000013,
    0x000001c9,
    0x000001c8,
    0x000500aa,
    0x00000134,
    0x000001ca,
    0x000001c9,
    0x00000053,
    0x000300f7,
    0x000001cc,
    0x00000000,
    0x000400fa,
    0x000001ca,
    0x000001cb,
    0x000001cc,
    0x000200f8,
    0x000001cb,
    0x00050041,
    0x00000140,
    0x000001cd,
    0x0000013f,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x000001ce,
    0x000001cd,
    0x000500aa,
    0x00000134,
    0x000001cf,
    0x000001ce,
    0x00000053,
    0x000200f9,
    0x000001cc,
    0x000200f8,
    0x000001cc,
    0x000700f5,
    0x00000134,
    0x000001d0,
    0x000001ca,
    0x0000019b,
    0x000001cf,
    0x000001cb,
    0x000300f7,
    0x000001d2,
    0x00000000,
    0x000400fa,
    0x000001d0,
    0x000001d1,
    0x000001d2,
    0x000200f8,
    0x000001d1,
    0x0003003e,
    0x000001d3,
    0x00000044,
    0x000200f9,
    0x000001d4,
    0x000200f8,
    0x000001d4,
    0x000400f6,
    0x000001d6,
    0x000001d7,
    0x00000000,
    0x000200f9,
    0x000001d8,
    0x000200f8,
    0x000001d8,
    0x0004003d,
    0x00000040,
    0x000001d9,
    0x000001d3,
    0x000500b1,
    0x00000134,
    0x000001da,
    0x000001d9,
    0x0000007e,
    0x000400fa,
    0x000001da,
    0x000001d5,
    0x000001d6,
    0x000200f8,
    0x000001d5,
    0x0004003d,
    0x00000040,
    0x000001db,
    0x000001d3,
    0x00060041,
    0x0000017b,
    0x000001dc,
    0x00000175,
    0x00000041,
    0x000001db,
    0x0004003d,
    0x00000006,
    0x000001dd,
    0x000001dc,
    0x00060041,
    0x0000017b,
    0x000001de,
    0x00000175,
    0x00000041,
    0x00000041,
    0x0004003d,
    0x00000006,
    0x000001df,
    0x000001de,
    0x00050081,
    0x00000006,
    0x000001e0,
    0x000001df,
    0x000001dd,
    0x00060041,
    0x0000017b,
    0x000001e1,
    0x00000175,
    0x00000041,
    0x00000041,
    0x0003003e,
    0x000001e1,
    0x000001e0,
    0x0003003e,
    0x000001e2,
    0x00000041,
    0x000200f9,
    0x000001e3,
    0x000200f8,
    0x000001e3,
    0x000400f6,
    0x000001e5,
    0x000001e6,
    0x00000000,
    0x000200f9,
    0x000001e7,
    0x000200f8,
    0x000001e7,
    0x0004003d,
    0x00000040,
    0x000001e8,
    0x000001e2,
    0x000500b1,
    0x00000134,
    0x000001e9,
    0x000001e8,
    0x00000133,
    0x000400fa,
    0x000001e9,
    0x000001e4,
    0x000001e5,
    0x000200f8,
    0x000001e4,
    0x0004003d,
    0x00000040,
    0x000001ea,
    0x000001e2,
    0x0004003d,
    0x00000040,
    0x000001eb,
    0x000001d3,
    0x0004003d,
    0x00000040,
    0x000001ec,
    0x000001e2,
    0x00080041,
    0x00000148,
    0x000001ed,
    0x0000013c,
    0x00000041,
    0x000001eb,
    0x00000041,
    0x000001ec,
    0x0004003d,
    0x00000011,
    0x000001ee,
    0x000001ed,
    0x00080041,
    0x00000148,
    0x000001ef,
    0x0000013c,
    0x00000041,
    0x00000041,
    0x00000041,
    0x000001ea,
    0x0004003d,
    0x00000011,
    0x000001f0,
    0x000001ef,
    0x00050081,
    0x00000011,
    0x000001f1,
    0x000001f0,
    0x000001ee,
    0x00080041,
    0x00000148,
    0x000001f2,
    0x0000013c,
    0x00000041,
    0x00000041,
    0x00000041,
    0x000001ea,
    0x0003003e,
    0x000001f2,
    0x000001f1,
    0x000200f9,
    0x000001e6,
    0x000200f8,
    0x000001e6,
    0x0004003d,
    0x00000040,
    0x000001f3,
    0x000001e2,
    0x00050080,
    0x00000040,
    0x000001f4,
    0x000001f3,
    0x00000044,
    0x0003003e,
    0x000001e2,
    0x000001f4,
    0x000200f9,
    0x000001e3,
    0x000200f8,
    0x000001e5,
    0x000200f9,
    0x000001d7,
    0x000200f8,
    0x000001d7,
    0x0004003d,
    0x00000040,
    0x000001f5,
    0x000001d3,
    0x00050080,
    0x00000040,
    0x000001f6,
    0x000001f5,
    0x00000044,
    0x0003003e,
    0x000001d3,
    0x000001f6,
    0x000200f9,
    0x000001d4,
    0x000200f8,
    0x000001d6,
    0x0003003e,
    0x000001f7,
    0x00000041,
    0x000200f9,
    0x000001f8,
    0x000200f8,
    0x000001f8,
    0x000400f6,
    0x000001fa,
    0x000001fb,
    0x00000000,
    0x000200f9,
    0x000001fc,
    0x000200f8,
    0x000001fc,
    0x0004003d,
    0x00000040,
    0x000001fd,
    0x000001f7,
    0x000500b1,
    0x00000134,
    0x000001fe,
    0x000001fd,
    0x00000133,
    0x000400fa,
    0x000001fe,
    0x000001f9,
    0x000001fa,
    0x000200f8,
    0x000001f9,
    0x0004003d,
    0x00000040,
    0x00000203,
    0x000001f7,
    0x00050084,
    0x00000040,
    0x00000204,
    0x00000202,
    0x00000203,
    0x0004007c,
    0x00000013,
    0x00000205,
    0x00000204,
    0x00050041,
    0x00000140,
    0x00000206,
    0x0000014e,
    0x00000053,
    0x0004003d,
    0x00000013,
    0x00000207,
    0x00000206,
    0x00050086,
    0x00000013,
    0x00000208,
    0x00000207,
    0x00000138,
    0x00050080,
    0x00000013,
    0x00000209,
    0x00000205,
    0x00000208,
    0x0004007c,
    0x00000040,
    0x0000020a,
    0x00000209,
    0x00050041,
    0x00000140,
    0x0000020b,
    0x0000014e,
    0x00000046,
    0x0004003d,
    0x00000013,
    0x0000020c,
    0x0000020b,
    0x00050086,
    0x00000013,
    0x0000020d,
    0x0000020c,
    0x00000138,
    0x0004007c,
    0x00000040,
    0x0000020e,
    0x0000020d,
    0x00050041,
    0x00000140,
    0x0000020f,
    0x0000014e,
    0x0000004d,
    0x0004003d,
    0x00000013,
    0x00000210,
    0x0000020f,
    0x0004007c,
    0x00000040,
    0x00000211,
    0x00000210,
    0x00060050,
    0x000001ff,
    0x00000212,
    0x0000020a,
    0x0000020e,
    0x00000211,
    0x0003003e,
    0x00000201,
    0x00000212,
    0x0004003d,
    0x00000213,
    0x00000216,
    0x00000215,
    0x0004003d,
    0x000001ff,
    0x00000217,
    0x00000201,
    0x0004003d,
    0x00000040,
    0x00000218,
    0x000001f7,
    0x00080041,
    0x00000148,
    0x00000219,
    0x0000013c,
    0x00000041,
    0x00000041,
    0x00000041,
    0x00000218,
    0x0004003d,
    0x00000011,
    0x0000021a,
    0x00000219,
    0x00060041,
    0x0000017b,
    0x0000021b,
    0x00000175,
    0x00000041,
    0x00000041,
    0x0004003d,
    0x00000006,
    0x0000021c,
    0x0000021b,
    0x00050051,
    0x00000006,
    0x0000021d,
    0x0000021a,
    0x00000000,
    0x00050051,
    0x00000006,
    0x0000021e,
    0x0000021a,
    0x00000001,
    0x00050051,
    0x00000006,
    0x0000021f,
    0x0000021a,
    0x00000002,
    0x00070050,
    0x00000168,
    0x00000220,
    0x0000021d,
    0x0000021e,
    0x0000021f,
    0x0000021c,
    0x00040063,
    0x00000216,
    0x00000217,
    0x00000220,
    0x000200f9,
    0x000001fb,
    0x000200f8,
    0x000001fb,
    0x0004003d,
    0x00000040,
    0x00000221,
    0x000001f7,
    0x00050080,
    0x00000040,
    0x00000222,
    0x00000221,
    0x00000044,
    0x0003003e,
    0x000001f7,
    0x00000222,
    0x000200f9,
    0x000001f8,
    0x000200f8,
    0x000001fa,
    0x000200f9,
    0x000001d2,
    0x000200f8,
    0x000001d2,
    0x000100fd,
    0x00010038,
    0x00050036,
    0x00000006,
    0x0000000b,
    0x00000000,
    0x00000008,
    0x00030037,
    0x00000007,
    0x00000009,
    0x00030037,
    0x00000007,
    0x0000000a,
    0x000200f8,
    0x0000000c,
    0x0004003d,
    0x00000006,
    0x00000029,
    0x00000009,
    0x0004003d,
    0x00000006,
    0x0000002a,
    0x0000000a,
    0x00050085,
    0x00000006,
    0x0000002b,
    0x00000029,
    0x0000002a,
    0x0004003d,
    0x00000006,
    0x0000002c,
    0x00000009,
    0x0004003d,
    0x00000006,
    0x0000002d,
    0x00000009,
    0x00050085,
    0x00000006,
    0x0000002e,
    0x0000002c,
    0x0000002d,
    0x0004003d,
    0x00000006,
    0x0000002f,
    0x0000000a,
    0x0004003d,
    0x00000006,
    0x00000030,
    0x0000000a,
    0x00050085,
    0x00000006,
    0x00000031,
    0x0000002f,
    0x00000030,
    0x00050081,
    0x00000006,
    0x00000032,
    0x0000002e,
    0x00000031,
    0x00050081,
    0x00000006,
    0x00000034,
    0x00000032,
    0x00000033,
    0x0006000c,
    0x00000006,
    0x00000035,
    0x00000001,
    0x0000001f,
    0x00000034,
    0x0007000c,
    0x00000006,
    0x00000036,
    0x00000001,
    0x00000019,
    0x0000002b,
    0x00000035,
    0x000200fe,
    0x00000036,
    0x00010038,
    0x00050036,
    0x00000006,
    0x0000000f,
    0x00000000,
    0x00000008,
    0x00030037,
    0x00000007,
    0x0000000d,
    0x00030037,
    0x00000007,
    0x0000000e,
    0x000200f8,
    0x00000010,
    0x0004003d,
    0x00000006,
    0x00000039,
    0x0000000d,
    0x00050081,
    0x00000006,
    0x0000003b,
    0x00000039,
    0x0000003a,
    0x0004003d,
    0x00000006,
    0x0000003c,
    0x0000000e,
    0x00050088,
    0x00000006,
    0x0000003d,
    0x0000003b,
    0x0000003c,
    0x000200fe,
    0x0000003d,
    0x00010038,
    0x00050036,
    0x00000002,
    0x0000001b,
    0x00000000,
    0x00000018,
    0x00030037,
    0x00000012,
    0x00000019,
    0x00030037,
    0x00000017,
    0x0000001a,
    0x000200f8,
    0x0000001c,
    0x00060041,
    0x00000007,
    0x00000043,
    0x0000001a,
    0x00000041,
    0x00000041,
    0x0003003e,
    0x00000043,
    0x00000042,
    0x00050041,
    0x00000007,
    0x00000047,
    0x00000019,
    0x00000046,
    0x0004003d,
    0x00000006,
    0x00000048,
    0x00000047,
    0x00050085,
    0x00000006,
    0x00000049,
    0x00000045,
    0x00000048,
    0x00060041,
    0x00000007,
    0x0000004a,
    0x0000001a,
    0x00000041,
    0x00000044,
    0x0003003e,
    0x0000004a,
    0x00000049,
    0x00050041,
    0x00000007,
    0x0000004e,
    0x00000019,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x0000004f,
    0x0000004e,
    0x00050085,
    0x00000006,
    0x00000050,
    0x0000004c,
    0x0000004f,
    0x00060041,
    0x00000007,
    0x00000051,
    0x0000001a,
    0x00000041,
    0x0000004b,
    0x0003003e,
    0x00000051,
    0x00000050,
    0x00050041,
    0x00000007,
    0x00000054,
    0x00000019,
    0x00000053,
    0x0004003d,
    0x00000006,
    0x00000055,
    0x00000054,
    0x00050085,
    0x00000006,
    0x00000056,
    0x00000045,
    0x00000055,
    0x00060041,
    0x00000007,
    0x00000057,
    0x0000001a,
    0x00000041,
    0x00000052,
    0x0003003e,
    0x00000057,
    0x00000056,
    0x00050041,
    0x00000007,
    0x0000005a,
    0x00000019,
    0x00000053,
    0x0004003d,
    0x00000006,
    0x0000005b,
    0x0000005a,
    0x00050085,
    0x00000006,
    0x0000005c,
    0x00000059,
    0x0000005b,
    0x00050041,
    0x00000007,
    0x0000005d,
    0x00000019,
    0x00000046,
    0x0004003d,
    0x00000006,
    0x0000005e,
    0x0000005d,
    0x00050085,
    0x00000006,
    0x0000005f,
    0x0000005c,
    0x0000005e,
    0x00060041,
    0x00000007,
    0x00000060,
    0x0000001a,
    0x00000041,
    0x00000058,
    0x0003003e,
    0x00000060,
    0x0000005f,
    0x00050041,
    0x00000007,
    0x00000063,
    0x00000019,
    0x00000046,
    0x0004003d,
    0x00000006,
    0x00000064,
    0x00000063,
    0x00050085,
    0x00000006,
    0x00000065,
    0x00000062,
    0x00000064,
    0x00050041,
    0x00000007,
    0x00000066,
    0x00000019,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x00000067,
    0x00000066,
    0x00050085,
    0x00000006,
    0x00000068,
    0x00000065,
    0x00000067,
    0x00060041,
    0x00000007,
    0x00000069,
    0x0000001a,
    0x00000041,
    0x00000061,
    0x0003003e,
    0x00000069,
    0x00000068,
    0x00050041,
    0x00000007,
    0x0000006d,
    0x00000019,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x0000006e,
    0x0000006d,
    0x00050085,
    0x00000006,
    0x0000006f,
    0x0000006c,
    0x0000006e,
    0x00050041,
    0x00000007,
    0x00000070,
    0x00000019,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x00000071,
    0x00000070,
    0x00050085,
    0x00000006,
    0x00000072,
    0x0000006f,
    0x00000071,
    0x00050083,
    0x00000006,
    0x00000073,
    0x00000072,
    0x00000033,
    0x00050085,
    0x00000006,
    0x00000074,
    0x0000006b,
    0x00000073,
    0x00060041,
    0x00000007,
    0x00000075,
    0x0000001a,
    0x00000041,
    0x0000006a,
    0x0003003e,
    0x00000075,
    0x00000074,
    0x00050041,
    0x00000007,
    0x00000077,
    0x00000019,
    0x00000053,
    0x0004003d,
    0x00000006,
    0x00000078,
    0x00000077,
    0x00050085,
    0x00000006,
    0x00000079,
    0x00000062,
    0x00000078,
    0x00050041,
    0x00000007,
    0x0000007a,
    0x00000019,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x0000007b,
    0x0000007a,
    0x00050085,
    0x00000006,
    0x0000007c,
    0x00000079,
    0x0000007b,
    0x00060041,
    0x00000007,
    0x0000007d,
    0x0000001a,
    0x00000041,
    0x00000076,
    0x0003003e,
    0x0000007d,
    0x0000007c,
    0x00050041,
    0x00000007,
    0x00000080,
    0x00000019,
    0x00000053,
    0x0004003d,
    0x00000006,
    0x00000081,
    0x00000080,
    0x00050041,
    0x00000007,
    0x00000082,
    0x00000019,
    0x00000053,
    0x0004003d,
    0x00000006,
    0x00000083,
    0x00000082,
    0x00050085,
    0x00000006,
    0x00000084,
    0x00000081,
    0x00000083,
    0x00050041,
    0x00000007,
    0x00000085,
    0x00000019,
    0x00000046,
    0x0004003d,
    0x00000006,
    0x00000086,
    0x00000085,
    0x00050041,
    0x00000007,
    0x00000087,
    0x00000019,
    0x00000046,
    0x0004003d,
    0x00000006,
    0x00000088,
    0x00000087,
    0x00050085,
    0x00000006,
    0x00000089,
    0x00000086,
    0x00000088,
    0x00050083,
    0x00000006,
    0x0000008a,
    0x00000084,
    0x00000089,
    0x00050085,
    0x00000006,
    0x0000008b,
    0x0000007f,
    0x0000008a,
    0x00060041,
    0x00000007,
    0x0000008c,
    0x0000001a,
    0x00000041,
    0x0000007e,
    0x0003003e,
    0x0000008c,
    0x0000008b,
    0x000100fd,
    0x00010038,
    0x00050036,
    0x00000006,
    0x00000021,
    0x00000000,
    0x0000001e,
    0x00030037,
    0x0000001d,
    0x0000001f,
    0x00030037,
    0x0000001d,
    0x00000020,
    0x000200f8,
    0x00000022,
    0x0004003b,
    0x00000007,
    0x0000008d,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x00000093,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x00000094,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x0000009c,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x0000009f,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000a0,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000a6,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000aa,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000ae,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000b2,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000b6,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000ba,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000bc,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000bf,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000c1,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000c5,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000c7,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000cb,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000cd,
    0x00000007,
    0x0004003d,
    0x00000013,
    0x0000008e,
    0x0000001f,
    0x00040070,
    0x00000006,
    0x0000008f,
    0x0000008e,
    0x0003003e,
    0x00000093,
    0x0000008f,
    0x00050041,
    0x00000095,
    0x00000096,
    0x00000092,
    0x00000041,
    0x0004003d,
    0x00000006,
    0x00000097,
    0x00000096,
    0x0003003e,
    0x00000094,
    0x00000097,
    0x00060039,
    0x00000006,
    0x00000098,
    0x0000000f,
    0x00000093,
    0x00000094,
    0x00050085,
    0x00000006,
    0x0000009a,
    0x00000098,
    0x00000099,
    0x00050083,
    0x00000006,
    0x0000009b,
    0x0000009a,
    0x00000033,
    0x0003003e,
    0x0000008d,
    0x0000009b,
    0x0004003d,
    0x00000013,
    0x0000009d,
    0x00000020,
    0x00040070,
    0x00000006,
    0x0000009e,
    0x0000009d,
    0x0003003e,
    0x0000009f,
    0x0000009e,
    0x00050041,
    0x00000095,
    0x000000a1,
    0x00000092,
    0x00000041,
    0x0004003d,
    0x00000006,
    0x000000a2,
    0x000000a1,
    0x0003003e,
    0x000000a0,
    0x000000a2,
    0x00060039,
    0x00000006,
    0x000000a3,
    0x0000000f,
    0x0000009f,
    0x000000a0,
    0x00050085,
    0x00000006,
    0x000000a4,
    0x000000a3,
    0x00000099,
    0x00050083,
    0x00000006,
    0x000000a5,
    0x000000a4,
    0x00000033,
    0x0003003e,
    0x0000009c,
    0x000000a5,
    0x00050041,
    0x00000095,
    0x000000a7,
    0x00000092,
    0x00000041,
    0x0004003d,
    0x00000006,
    0x000000a8,
    0x000000a7,
    0x00050088,
    0x00000006,
    0x000000a9,
    0x00000033,
    0x000000a8,
    0x0003003e,
    0x000000a6,
    0x000000a9,
    0x0004003d,
    0x00000006,
    0x000000ab,
    0x0000008d,
    0x0004003d,
    0x00000006,
    0x000000ac,
    0x000000a6,
    0x00050083,
    0x00000006,
    0x000000ad,
    0x000000ab,
    0x000000ac,
    0x0003003e,
    0x000000aa,
    0x000000ad,
    0x0004003d,
    0x00000006,
    0x000000af,
    0x0000009c,
    0x0004003d,
    0x00000006,
    0x000000b0,
    0x000000a6,
    0x00050083,
    0x00000006,
    0x000000b1,
    0x000000af,
    0x000000b0,
    0x0003003e,
    0x000000ae,
    0x000000b1,
    0x0004003d,
    0x00000006,
    0x000000b3,
    0x0000008d,
    0x0004003d,
    0x00000006,
    0x000000b4,
    0x000000a6,
    0x00050081,
    0x00000006,
    0x000000b5,
    0x000000b3,
    0x000000b4,
    0x0003003e,
    0x000000b2,
    0x000000b5,
    0x0004003d,
    0x00000006,
    0x000000b7,
    0x0000009c,
    0x0004003d,
    0x00000006,
    0x000000b8,
    0x000000a6,
    0x00050081,
    0x00000006,
    0x000000b9,
    0x000000b7,
    0x000000b8,
    0x0003003e,
    0x000000b6,
    0x000000b9,
    0x0004003d,
    0x00000006,
    0x000000bb,
    0x000000aa,
    0x0003003e,
    0x000000ba,
    0x000000bb,
    0x0004003d,
    0x00000006,
    0x000000bd,
    0x000000ae,
    0x0003003e,
    0x000000bc,
    0x000000bd,
    0x00060039,
    0x00000006,
    0x000000be,
    0x0000000b,
    0x000000ba,
    0x000000bc,
    0x0004003d,
    0x00000006,
    0x000000c0,
    0x000000aa,
    0x0003003e,
    0x000000bf,
    0x000000c0,
    0x0004003d,
    0x00000006,
    0x000000c2,
    0x000000b6,
    0x0003003e,
    0x000000c1,
    0x000000c2,
    0x00060039,
    0x00000006,
    0x000000c3,
    0x0000000b,
    0x000000bf,
    0x000000c1,
    0x00050083,
    0x00000006,
    0x000000c4,
    0x000000be,
    0x000000c3,
    0x0004003d,
    0x00000006,
    0x000000c6,
    0x000000b2,
    0x0003003e,
    0x000000c5,
    0x000000c6,
    0x0004003d,
    0x00000006,
    0x000000c8,
    0x000000ae,
    0x0003003e,
    0x000000c7,
    0x000000c8,
    0x00060039,
    0x00000006,
    0x000000c9,
    0x0000000b,
    0x000000c5,
    0x000000c7,
    0x00050083,
    0x00000006,
    0x000000ca,
    0x000000c4,
    0x000000c9,
    0x0004003d,
    0x00000006,
    0x000000cc,
    0x000000b2,
    0x0003003e,
    0x000000cb,
    0x000000cc,
    0x0004003d,
    0x00000006,
    0x000000ce,
    0x000000b6,
    0x0003003e,
    0x000000cd,
    0x000000ce,
    0x00060039,
    0x00000006,
    0x000000cf,
    0x0000000b,
    0x000000cb,
    0x000000cd,
    0x00050081,
    0x00000006,
    0x000000d0,
    0x000000ca,
    0x000000cf,
    0x000200fe,
    0x000000d0,
    0x00010038,
    0x00050036,
    0x00000011,
    0x00000027,
    0x00000000,
    0x00000023,
    0x00030037,
    0x0000001d,
    0x00000024,
    0x00030037,
    0x0000001d,
    0x00000025,
    0x00030037,
    0x0000001d,
    0x00000026,
    0x000200f8,
    0x00000028,
    0x0004003b,
    0x00000007,
    0x000000d3,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000d6,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000d7,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000dd,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000e0,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000e1,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000ef,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000f1,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x000000f4,
    0x00000007,
    0x0004003b,
    0x00000007,
    0x0000010d,
    0x00000007,
    0x0004003b,
    0x00000012,
    0x0000011b,
    0x00000007,
    0x0004003d,
    0x00000013,
    0x000000d4,
    0x00000025,
    0x00040070,
    0x00000006,
    0x000000d5,
    0x000000d4,
    0x0003003e,
    0x000000d6,
    0x000000d5,
    0x00050041,
    0x00000095,
    0x000000d8,
    0x00000092,
    0x00000041,
    0x0004003d,
    0x00000006,
    0x000000d9,
    0x000000d8,
    0x0003003e,
    0x000000d7,
    0x000000d9,
    0x00060039,
    0x00000006,
    0x000000da,
    0x0000000f,
    0x000000d6,
    0x000000d7,
    0x00050085,
    0x00000006,
    0x000000db,
    0x000000da,
    0x00000099,
    0x00050083,
    0x00000006,
    0x000000dc,
    0x000000db,
    0x00000033,
    0x0003003e,
    0x000000d3,
    0x000000dc,
    0x0004003d,
    0x00000013,
    0x000000de,
    0x00000026,
    0x00040070,
    0x00000006,
    0x000000df,
    0x000000de,
    0x0003003e,
    0x000000e0,
    0x000000df,
    0x00050041,
    0x00000095,
    0x000000e2,
    0x00000092,
    0x00000041,
    0x0004003d,
    0x00000006,
    0x000000e3,
    0x000000e2,
    0x0003003e,
    0x000000e1,
    0x000000e3,
    0x00060039,
    0x00000006,
    0x000000e4,
    0x0000000f,
    0x000000e0,
    0x000000e1,
    0x00050085,
    0x00000006,
    0x000000e5,
    0x000000e4,
    0x00000099,
    0x00050083,
    0x00000006,
    0x000000e6,
    0x000000e5,
    0x00000033,
    0x0003003e,
    0x000000dd,
    0x000000e6,
    0x0004003d,
    0x00000013,
    0x000000e7,
    0x00000024,
    0x000300f7,
    0x000000ee,
    0x00000000,
    0x000f00fb,
    0x000000e7,
    0x000000ee,
    0x00000004,
    0x000000e8,
    0x00000005,
    0x000000e9,
    0x00000001,
    0x000000ea,
    0x00000000,
    0x000000eb,
    0x00000002,
    0x000000ec,
    0x00000003,
    0x000000ed,
    0x000200f8,
    0x000000e8,
    0x0004003d,
    0x00000006,
    0x000000f0,
    0x000000d3,
    0x0003003e,
    0x000000ef,
    0x000000f0,
    0x0004003d,
    0x00000006,
    0x000000f2,
    0x000000dd,
    0x0004007f,
    0x00000006,
    0x000000f3,
    0x000000f2,
    0x0003003e,
    0x000000f1,
    0x000000f3,
    0x0003003e,
    0x000000f4,
    0x00000033,
    0x000200f9,
    0x000000ee,
    0x000200f8,
    0x000000e9,
    0x0004003d,
    0x00000006,
    0x000000f6,
    0x000000d3,
    0x0004007f,
    0x00000006,
    0x000000f7,
    0x000000f6,
    0x0003003e,
    0x000000ef,
    0x000000f7,
    0x0004003d,
    0x00000006,
    0x000000f8,
    0x000000dd,
    0x0004007f,
    0x00000006,
    0x000000f9,
    0x000000f8,
    0x0003003e,
    0x000000f1,
    0x000000f9,
    0x0003003e,
    0x000000f4,
    0x000000fa,
    0x000200f9,
    0x000000ee,
    0x000200f8,
    0x000000ea,
    0x0003003e,
    0x000000ef,
    0x000000fa,
    0x0004003d,
    0x00000006,
    0x000000fc,
    0x000000dd,
    0x0004007f,
    0x00000006,
    0x000000fd,
    0x000000fc,
    0x0003003e,
    0x000000f1,
    0x000000fd,
    0x0004003d,
    0x00000006,
    0x000000fe,
    0x000000d3,
    0x0003003e,
    0x000000f4,
    0x000000fe,
    0x000200f9,
    0x000000ee,
    0x000200f8,
    0x000000eb,
    0x0003003e,
    0x000000ef,
    0x00000033,
    0x0004003d,
    0x00000006,
    0x00000100,
    0x000000dd,
    0x0004007f,
    0x00000006,
    0x00000101,
    0x00000100,
    0x0003003e,
    0x000000f1,
    0x00000101,
    0x0004003d,
    0x00000006,
    0x00000102,
    0x000000d3,
    0x0004007f,
    0x00000006,
    0x00000103,
    0x00000102,
    0x0003003e,
    0x000000f4,
    0x00000103,
    0x000200f9,
    0x000000ee,
    0x000200f8,
    0x000000ec,
    0x0004003d,
    0x00000006,
    0x00000105,
    0x000000d3,
    0x0003003e,
    0x000000ef,
    0x00000105,
    0x0003003e,
    0x000000f1,
    0x00000033,
    0x0004003d,
    0x00000006,
    0x00000106,
    0x000000dd,
    0x0003003e,
    0x000000f4,
    0x00000106,
    0x000200f9,
    0x000000ee,
    0x000200f8,
    0x000000ed,
    0x0004003d,
    0x00000006,
    0x00000108,
    0x000000d3,
    0x0003003e,
    0x000000ef,
    0x00000108,
    0x0003003e,
    0x000000f1,
    0x000000fa,
    0x0004003d,
    0x00000006,
    0x00000109,
    0x000000dd,
    0x0004007f,
    0x00000006,
    0x0000010a,
    0x00000109,
    0x0003003e,
    0x000000f4,
    0x0000010a,
    0x000200f9,
    0x000000ee,
    0x000200f8,
    0x000000ee,
    0x0004003d,
    0x00000006,
    0x0000010e,
    0x000000ef,
    0x0004003d,
    0x00000006,
    0x0000010f,
    0x000000ef,
    0x00050085,
    0x00000006,
    0x00000110,
    0x0000010e,
    0x0000010f,
    0x0004003d,
    0x00000006,
    0x00000111,
    0x000000f1,
    0x0004003d,
    0x00000006,
    0x00000112,
    0x000000f1,
    0x00050085,
    0x00000006,
    0x00000113,
    0x00000111,
    0x00000112,
    0x00050081,
    0x00000006,
    0x00000114,
    0x00000110,
    0x00000113,
    0x0004003d,
    0x00000006,
    0x00000115,
    0x000000f4,
    0x0004003d,
    0x00000006,
    0x00000116,
    0x000000f4,
    0x00050085,
    0x00000006,
    0x00000117,
    0x00000115,
    0x00000116,
    0x00050081,
    0x00000006,
    0x00000118,
    0x00000114,
    0x00000117,
    0x0006000c,
    0x00000006,
    0x00000119,
    0x00000001,
    0x0000001f,
    0x00000118,
    0x00050088,
    0x00000006,
    0x0000011a,
    0x00000033,
    0x00000119,
    0x0003003e,
    0x0000010d,
    0x0000011a,
    0x0004003d,
    0x00000006,
    0x0000011c,
    0x000000ef,
    0x0004003d,
    0x00000006,
    0x0000011d,
    0x0000010d,
    0x00050085,
    0x00000006,
    0x0000011e,
    0x0000011c,
    0x0000011d,
    0x00050041,
    0x00000007,
    0x0000011f,
    0x0000011b,
    0x00000053,
    0x0003003e,
    0x0000011f,
    0x0000011e,
    0x0004003d,
    0x00000006,
    0x00000120,
    0x000000f1,
    0x0004003d,
    0x00000006,
    0x00000121,
    0x0000010d,
    0x00050085,
    0x00000006,
    0x00000122,
    0x00000120,
    0x00000121,
    0x00050041,
    0x00000007,
    0x00000123,
    0x0000011b,
    0x00000046,
    0x0003003e,
    0x00000123,
    0x00000122,
    0x0004003d,
    0x00000006,
    0x00000124,
    0x000000f4,
    0x0004003d,
    0x00000006,
    0x00000125,
    0x0000010d,
    0x00050085,
    0x00000006,
    0x00000126,
    0x00000124,
    0x00000125,
    0x00050041,
    0x00000007,
    0x00000127,
    0x0000011b,
    0x0000004d,
    0x0003003e,
    0x00000127,
    0x00000126,
    0x0004003d,
    0x00000011,
    0x00000128,
    0x0000011b,
    0x000200fe,
    0x00000128,
    0x00010038,
};

// -----------------------------------------------------------------------------------------------------------------------------------

static const unsigned int kSH_ADD_SPIRV_size           = 4492;
static const unsigned int kSH_ADD_SPIRV_data[4492 / 4] = {
    0x07230203,
    0x00010500,
    0x0008000a,
    0x000000cb,
    0x00000000,
    0x00020011,
    0x00000001,
    0x0006000b,
    0x00000001,
    0x4c534c47,
    0x6474732e,
    0x3035342e,
    0x00000000,
    0x0003000e,
    0x00000000,
    0x00000001,
    0x000a000f,
    0x00000005,
    0x00000004,
    0x6e69616d,
    0x00000000,
    0x0000000e,
    0x00000011,
    0x00000020,
    0x0000004a,
    0x000000b8,
    0x00060010,
    0x00000004,
    0x00000011,
    0x00000001,
    0x00000010,
    0x00000006,
    0x00030003,
    0x00000002,
    0x000001c2,
    0x00040005,
    0x00000004,
    0x6e69616d,
    0x00000000,
    0x00050005,
    0x0000000e,
    0x68735f67,
    0x656f635f,
    0x00736666,
    0x00080005,
    0x00000011,
    0x475f6c67,
    0x61626f6c,
    0x766e496c,
    0x7461636f,
    0x496e6f69,
    0x00000044,
    0x00050005,
    0x00000020,
    0x65775f67,
    0x74686769,
    0x00000073,
    0x00030005,
    0x00000029,
    0x00000069,
    0x00030005,
    0x00000036,
    0x00000070,
    0x00030005,
    0x00000046,
    0x006c6176,
    0x00070005,
    0x0000004a,
    0x48535f73,
    0x65746e49,
    0x64656d72,
    0x65746169,
    0x00000000,
    0x00030005,
    0x0000006e,
    0x00000069,
    0x00030005,
    0x00000099,
    0x00000069,
    0x00040005,
    0x000000b1,
    0x6c616373,
    0x00000065,
    0x00040005,
    0x000000b8,
    0x48535f69,
    0x00000000,
    0x00040047,
    0x00000011,
    0x0000000b,
    0x0000001c,
    0x00040047,
    0x0000004a,
    0x00000022,
    0x00000000,
    0x00040047,
    0x0000004a,
    0x00000021,
    0x00000001,
    0x00040047,
    0x000000b8,
    0x00000022,
    0x00000000,
    0x00040047,
    0x000000b8,
    0x00000021,
    0x00000000,
    0x00040047,
    0x000000ca,
    0x0000000b,
    0x00000019,
    0x00020013,
    0x00000002,
    0x00030021,
    0x00000003,
    0x00000002,
    0x00030016,
    0x00000006,
    0x00000020,
    0x00040017,
    0x00000007,
    0x00000006,
    0x00000003,
    0x00040015,
    0x00000008,
    0x00000020,
    0x00000000,
    0x0004002b,
    0x00000008,
    0x00000009,
    0x00000006,
    0x0004001c,
    0x0000000a,
    0x00000007,
    0x00000009,
    0x0004002b,
    0x00000008,
    0x0000000b,
    0x00000010,
    0x0004001c,
    0x0000000c,
    0x0000000a,
    0x0000000b,
    0x00040020,
    0x0000000d,
    0x00000004,
    0x0000000c,
    0x0004003b,
    0x0000000d,
    0x0000000e,
    0x00000004,
    0x00040017,
    0x0000000f,
    0x00000008,
    0x00000003,
    0x00040020,
    0x00000010,
    0x00000001,
    0x0000000f,
    0x0004003b,
    0x00000010,
    0x00000011,
    0x00000001,
    0x0004002b,
    0x00000008,
    0x00000012,
    0x00000001,
    0x00040020,
    0x00000013,
    0x00000001,
    0x00000008,
    0x0004002b,
    0x00000008,
    0x00000016,
    0x00000002,
    0x0004002b,
    0x00000006,
    0x00000019,
    0x00000000,
    0x0006002c,
    0x00000007,
    0x0000001a,
    0x00000019,
    0x00000019,
    0x00000019,
    0x00040020,
    0x0000001b,
    0x00000004,
    0x00000007,
    0x0004001c,
    0x0000001d,
    0x00000006,
    0x00000009,
    0x0004001c,
    0x0000001e,
    0x0000001d,
    0x0000000b,
    0x00040020,
    0x0000001f,
    0x00000004,
    0x0000001e,
    0x0004003b,
    0x0000001f,
    0x00000020,
    0x00000004,
    0x00040020,
    0x00000025,
    0x00000004,
    0x00000006,
    0x0004002b,
    0x00000008,
    0x00000027,
    0x00000108,
    0x00040020,
    0x00000028,
    0x00000007,
    0x00000008,
    0x0004002b,
    0x00000008,
    0x0000002a,
    0x00000000,
    0x00020014,
    0x00000031,
    0x00040015,
    0x00000033,
    0x00000020,
    0x00000001,
    0x00040017,
    0x00000034,
    0x00000033,
    0x00000003,
    0x00040020,
    0x00000035,
    0x00000007,
    0x00000034,
    0x00040017,
    0x00000044,
    0x00000006,
    0x00000004,
    0x00040020,
    0x00000045,
    0x00000007,
    0x00000044,
    0x00090019,
    0x00000047,
    0x00000006,
    0x00000001,
    0x00000000,
    0x00000001,
    0x00000000,
    0x00000001,
    0x00000000,
    0x0003001b,
    0x00000048,
    0x00000047,
    0x00040020,
    0x00000049,
    0x00000000,
    0x00000048,
    0x0004003b,
    0x00000049,
    0x0000004a,
    0x00000000,
    0x0004002b,
    0x00000033,
    0x0000004d,
    0x00000000,
    0x0004002b,
    0x00000008,
    0x0000005e,
    0x00000003,
    0x00040020,
    0x0000005f,
    0x00000007,
    0x00000006,
    0x0004002b,
    0x00000033,
    0x00000067,
    0x00000001,
    0x0004002b,
    0x00000006,
    0x000000b2,
    0x41490fdb,
    0x00090019,
    0x000000b6,
    0x00000006,
    0x00000001,
    0x00000000,
    0x00000000,
    0x00000000,
    0x00000002,
    0x00000001,
    0x00040020,
    0x000000b7,
    0x00000000,
    0x000000b6,
    0x0004003b,
    0x000000b7,
    0x000000b8,
    0x00000000,
    0x00040017,
    0x000000bd,
    0x00000033,
    0x00000002,
    0x0004002b,
    0x00000006,
    0x000000c9,
    0x40490fdb,
    0x0006002c,
    0x0000000f,
    0x000000ca,
    0x00000012,
    0x0000000b,
    0x00000009,
    0x00050036,
    0x00000002,
    0x00000004,
    0x00000000,
    0x00000003,
    0x000200f8,
    0x00000005,
    0x0004003b,
    0x00000028,
    0x00000029,
    0x00000007,
    0x0004003b,
    0x00000035,
    0x00000036,
    0x00000007,
    0x0004003b,
    0x00000045,
    0x00000046,
    0x00000007,
    0x0004003b,
    0x00000028,
    0x0000006e,
    0x00000007,
    0x0004003b,
    0x00000028,
    0x00000099,
    0x00000007,
    0x0004003b,
    0x0000005f,
    0x000000b1,
    0x00000007,
    0x00050041,
    0x00000013,
    0x00000014,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x00000015,
    0x00000014,
    0x00050041,
    0x00000013,
    0x00000017,
    0x00000011,
    0x00000016,
    0x0004003d,
    0x00000008,
    0x00000018,
    0x00000017,
    0x00060041,
    0x0000001b,
    0x0000001c,
    0x0000000e,
    0x00000015,
    0x00000018,
    0x0003003e,
    0x0000001c,
    0x0000001a,
    0x00050041,
    0x00000013,
    0x00000021,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x00000022,
    0x00000021,
    0x00050041,
    0x00000013,
    0x00000023,
    0x00000011,
    0x00000016,
    0x0004003d,
    0x00000008,
    0x00000024,
    0x00000023,
    0x00060041,
    0x00000025,
    0x00000026,
    0x00000020,
    0x00000022,
    0x00000024,
    0x0003003e,
    0x00000026,
    0x00000019,
    0x000400e0,
    0x00000016,
    0x00000016,
    0x00000027,
    0x0003003e,
    0x00000029,
    0x0000002a,
    0x000200f9,
    0x0000002b,
    0x000200f8,
    0x0000002b,
    0x000400f6,
    0x0000002d,
    0x0000002e,
    0x00000000,
    0x000200f9,
    0x0000002f,
    0x000200f8,
    0x0000002f,
    0x0004003d,
    0x00000008,
    0x00000030,
    0x00000029,
    0x000500b0,
    0x00000031,
    0x00000032,
    0x00000030,
    0x0000000b,
    0x000400fa,
    0x00000032,
    0x0000002c,
    0x0000002d,
    0x000200f8,
    0x0000002c,
    0x00050041,
    0x00000013,
    0x00000037,
    0x00000011,
    0x0000002a,
    0x0004003d,
    0x00000008,
    0x00000038,
    0x00000037,
    0x00050084,
    0x00000008,
    0x00000039,
    0x00000038,
    0x0000000b,
    0x0004003d,
    0x00000008,
    0x0000003a,
    0x00000029,
    0x00050080,
    0x00000008,
    0x0000003b,
    0x00000039,
    0x0000003a,
    0x0004007c,
    0x00000033,
    0x0000003c,
    0x0000003b,
    0x00050041,
    0x00000013,
    0x0000003d,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x0000003e,
    0x0000003d,
    0x0004007c,
    0x00000033,
    0x0000003f,
    0x0000003e,
    0x00050041,
    0x00000013,
    0x00000040,
    0x00000011,
    0x00000016,
    0x0004003d,
    0x00000008,
    0x00000041,
    0x00000040,
    0x0004007c,
    0x00000033,
    0x00000042,
    0x00000041,
    0x00060050,
    0x00000034,
    0x00000043,
    0x0000003c,
    0x0000003f,
    0x00000042,
    0x0003003e,
    0x00000036,
    0x00000043,
    0x0004003d,
    0x00000048,
    0x0000004b,
    0x0000004a,
    0x0004003d,
    0x00000034,
    0x0000004c,
    0x00000036,
    0x00040064,
    0x00000047,
    0x0000004e,
    0x0000004b,
    0x0007005f,
    0x00000044,
    0x0000004f,
    0x0000004e,
    0x0000004c,
    0x00000002,
    0x0000004d,
    0x0003003e,
    0x00000046,
    0x0000004f,
    0x00050041,
    0x00000013,
    0x00000050,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x00000051,
    0x00000050,
    0x00050041,
    0x00000013,
    0x00000052,
    0x00000011,
    0x00000016,
    0x0004003d,
    0x00000008,
    0x00000053,
    0x00000052,
    0x0004003d,
    0x00000044,
    0x00000054,
    0x00000046,
    0x0008004f,
    0x00000007,
    0x00000055,
    0x00000054,
    0x00000054,
    0x00000000,
    0x00000001,
    0x00000002,
    0x00060041,
    0x0000001b,
    0x00000056,
    0x0000000e,
    0x00000051,
    0x00000053,
    0x0004003d,
    0x00000007,
    0x00000057,
    0x00000056,
    0x00050081,
    0x00000007,
    0x00000058,
    0x00000057,
    0x00000055,
    0x00060041,
    0x0000001b,
    0x00000059,
    0x0000000e,
    0x00000051,
    0x00000053,
    0x0003003e,
    0x00000059,
    0x00000058,
    0x00050041,
    0x00000013,
    0x0000005a,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x0000005b,
    0x0000005a,
    0x00050041,
    0x00000013,
    0x0000005c,
    0x00000011,
    0x00000016,
    0x0004003d,
    0x00000008,
    0x0000005d,
    0x0000005c,
    0x00050041,
    0x0000005f,
    0x00000060,
    0x00000046,
    0x0000005e,
    0x0004003d,
    0x00000006,
    0x00000061,
    0x00000060,
    0x00060041,
    0x00000025,
    0x00000062,
    0x00000020,
    0x0000005b,
    0x0000005d,
    0x0004003d,
    0x00000006,
    0x00000063,
    0x00000062,
    0x00050081,
    0x00000006,
    0x00000064,
    0x00000063,
    0x00000061,
    0x00060041,
    0x00000025,
    0x00000065,
    0x00000020,
    0x0000005b,
    0x0000005d,
    0x0003003e,
    0x00000065,
    0x00000064,
    0x000200f9,
    0x0000002e,
    0x000200f8,
    0x0000002e,
    0x0004003d,
    0x00000008,
    0x00000066,
    0x00000029,
    0x00050080,
    0x00000008,
    0x00000068,
    0x00000066,
    0x00000067,
    0x0003003e,
    0x00000029,
    0x00000068,
    0x000200f9,
    0x0000002b,
    0x000200f8,
    0x0000002d,
    0x000400e0,
    0x00000016,
    0x00000016,
    0x00000027,
    0x00050041,
    0x00000013,
    0x00000069,
    0x00000011,
    0x00000016,
    0x0004003d,
    0x00000008,
    0x0000006a,
    0x00000069,
    0x000500aa,
    0x00000031,
    0x0000006b,
    0x0000006a,
    0x0000002a,
    0x000300f7,
    0x0000006d,
    0x00000000,
    0x000400fa,
    0x0000006b,
    0x0000006c,
    0x0000006d,
    0x000200f8,
    0x0000006c,
    0x0003003e,
    0x0000006e,
    0x00000012,
    0x000200f9,
    0x0000006f,
    0x000200f8,
    0x0000006f,
    0x000400f6,
    0x00000071,
    0x00000072,
    0x00000000,
    0x000200f9,
    0x00000073,
    0x000200f8,
    0x00000073,
    0x0004003d,
    0x00000008,
    0x00000074,
    0x0000006e,
    0x000500b0,
    0x00000031,
    0x00000075,
    0x00000074,
    0x00000009,
    0x000400fa,
    0x00000075,
    0x00000070,
    0x00000071,
    0x000200f8,
    0x00000070,
    0x00050041,
    0x00000013,
    0x00000076,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x00000077,
    0x00000076,
    0x00050041,
    0x00000013,
    0x00000078,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x00000079,
    0x00000078,
    0x0004003d,
    0x00000008,
    0x0000007a,
    0x0000006e,
    0x00060041,
    0x0000001b,
    0x0000007b,
    0x0000000e,
    0x00000079,
    0x0000007a,
    0x0004003d,
    0x00000007,
    0x0000007c,
    0x0000007b,
    0x00060041,
    0x0000001b,
    0x0000007d,
    0x0000000e,
    0x00000077,
    0x0000004d,
    0x0004003d,
    0x00000007,
    0x0000007e,
    0x0000007d,
    0x00050081,
    0x00000007,
    0x0000007f,
    0x0000007e,
    0x0000007c,
    0x00060041,
    0x0000001b,
    0x00000080,
    0x0000000e,
    0x00000077,
    0x0000004d,
    0x0003003e,
    0x00000080,
    0x0000007f,
    0x00050041,
    0x00000013,
    0x00000081,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x00000082,
    0x00000081,
    0x00050041,
    0x00000013,
    0x00000083,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x00000084,
    0x00000083,
    0x0004003d,
    0x00000008,
    0x00000085,
    0x0000006e,
    0x00060041,
    0x00000025,
    0x00000086,
    0x00000020,
    0x00000084,
    0x00000085,
    0x0004003d,
    0x00000006,
    0x00000087,
    0x00000086,
    0x00060041,
    0x00000025,
    0x00000088,
    0x00000020,
    0x00000082,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x00000089,
    0x00000088,
    0x00050081,
    0x00000006,
    0x0000008a,
    0x00000089,
    0x00000087,
    0x00060041,
    0x00000025,
    0x0000008b,
    0x00000020,
    0x00000082,
    0x0000004d,
    0x0003003e,
    0x0000008b,
    0x0000008a,
    0x000200f9,
    0x00000072,
    0x000200f8,
    0x00000072,
    0x0004003d,
    0x00000008,
    0x0000008c,
    0x0000006e,
    0x00050080,
    0x00000008,
    0x0000008d,
    0x0000008c,
    0x00000067,
    0x0003003e,
    0x0000006e,
    0x0000008d,
    0x000200f9,
    0x0000006f,
    0x000200f8,
    0x00000071,
    0x000200f9,
    0x0000006d,
    0x000200f8,
    0x0000006d,
    0x000400e0,
    0x00000016,
    0x00000016,
    0x00000027,
    0x00050041,
    0x00000013,
    0x0000008e,
    0x00000011,
    0x00000012,
    0x0004003d,
    0x00000008,
    0x0000008f,
    0x0000008e,
    0x000500aa,
    0x00000031,
    0x00000090,
    0x0000008f,
    0x0000002a,
    0x000300f7,
    0x00000092,
    0x00000000,
    0x000400fa,
    0x00000090,
    0x00000091,
    0x00000092,
    0x000200f8,
    0x00000091,
    0x00050041,
    0x00000013,
    0x00000093,
    0x00000011,
    0x00000016,
    0x0004003d,
    0x00000008,
    0x00000094,
    0x00000093,
    0x000500aa,
    0x00000031,
    0x00000095,
    0x00000094,
    0x0000002a,
    0x000200f9,
    0x00000092,
    0x000200f8,
    0x00000092,
    0x000700f5,
    0x00000031,
    0x00000096,
    0x00000090,
    0x0000006d,
    0x00000095,
    0x00000091,
    0x000300f7,
    0x00000098,
    0x00000000,
    0x000400fa,
    0x00000096,
    0x00000097,
    0x00000098,
    0x000200f8,
    0x00000097,
    0x0003003e,
    0x00000099,
    0x00000012,
    0x000200f9,
    0x0000009a,
    0x000200f8,
    0x0000009a,
    0x000400f6,
    0x0000009c,
    0x0000009d,
    0x00000000,
    0x000200f9,
    0x0000009e,
    0x000200f8,
    0x0000009e,
    0x0004003d,
    0x00000008,
    0x0000009f,
    0x00000099,
    0x000500b0,
    0x00000031,
    0x000000a0,
    0x0000009f,
    0x0000000b,
    0x000400fa,
    0x000000a0,
    0x0000009b,
    0x0000009c,
    0x000200f8,
    0x0000009b,
    0x0004003d,
    0x00000008,
    0x000000a1,
    0x00000099,
    0x00060041,
    0x0000001b,
    0x000000a2,
    0x0000000e,
    0x000000a1,
    0x0000004d,
    0x0004003d,
    0x00000007,
    0x000000a3,
    0x000000a2,
    0x00060041,
    0x0000001b,
    0x000000a4,
    0x0000000e,
    0x0000004d,
    0x0000004d,
    0x0004003d,
    0x00000007,
    0x000000a5,
    0x000000a4,
    0x00050081,
    0x00000007,
    0x000000a6,
    0x000000a5,
    0x000000a3,
    0x00060041,
    0x0000001b,
    0x000000a7,
    0x0000000e,
    0x0000004d,
    0x0000004d,
    0x0003003e,
    0x000000a7,
    0x000000a6,
    0x0004003d,
    0x00000008,
    0x000000a8,
    0x00000099,
    0x00060041,
    0x00000025,
    0x000000a9,
    0x00000020,
    0x000000a8,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x000000aa,
    0x000000a9,
    0x00060041,
    0x00000025,
    0x000000ab,
    0x00000020,
    0x0000004d,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x000000ac,
    0x000000ab,
    0x00050081,
    0x00000006,
    0x000000ad,
    0x000000ac,
    0x000000aa,
    0x00060041,
    0x00000025,
    0x000000ae,
    0x00000020,
    0x0000004d,
    0x0000004d,
    0x0003003e,
    0x000000ae,
    0x000000ad,
    0x000200f9,
    0x0000009d,
    0x000200f8,
    0x0000009d,
    0x0004003d,
    0x00000008,
    0x000000af,
    0x00000099,
    0x00050080,
    0x00000008,
    0x000000b0,
    0x000000af,
    0x00000067,
    0x0003003e,
    0x00000099,
    0x000000b0,
    0x000200f9,
    0x0000009a,
    0x000200f8,
    0x0000009c,
    0x00060041,
    0x00000025,
    0x000000b3,
    0x00000020,
    0x0000004d,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x000000b4,
    0x000000b3,
    0x00050088,
    0x00000006,
    0x000000b5,
    0x000000b2,
    0x000000b4,
    0x0003003e,
    0x000000b1,
    0x000000b5,
    0x0004003d,
    0x000000b6,
    0x000000b9,
    0x000000b8,
    0x00050041,
    0x00000013,
    0x000000ba,
    0x00000011,
    0x0000002a,
    0x0004003d,
    0x00000008,
    0x000000bb,
    0x000000ba,
    0x0004007c,
    0x00000033,
    0x000000bc,
    0x000000bb,
    0x00050050,
    0x000000bd,
    0x000000be,
    0x000000bc,
    0x0000004d,
    0x00060041,
    0x0000001b,
    0x000000bf,
    0x0000000e,
    0x0000004d,
    0x0000004d,
    0x0004003d,
    0x00000007,
    0x000000c0,
    0x000000bf,
    0x0004003d,
    0x00000006,
    0x000000c1,
    0x000000b1,
    0x0005008e,
    0x00000007,
    0x000000c2,
    0x000000c0,
    0x000000c1,
    0x00060041,
    0x00000025,
    0x000000c3,
    0x00000020,
    0x0000004d,
    0x0000004d,
    0x0004003d,
    0x00000006,
    0x000000c4,
    0x000000c3,
    0x00050051,
    0x00000006,
    0x000000c5,
    0x000000c2,
    0x00000000,
    0x00050051,
    0x00000006,
    0x000000c6,
    0x000000c2,
    0x00000001,
    0x00050051,
    0x00000006,
    0x000000c7,
    0x000000c2,
    0x00000002,
    0x00070050,
    0x00000044,
    0x000000c8,
    0x000000c5,
    0x000000c6,
    0x000000c7,
    0x000000c4,
    0x00040063,
    0x000000b9,
    0x000000be,
    0x000000c8,
    0x000200f9,
    0x00000098,
    0x000200f8,
    0x00000098,
    0x000100fd,
    0x00010038,
};

#else
static const char* g_cs_projection_src = R"(
// ------------------------------------------------------------------
// CONSTANTS --------------------------------------------------------
// ------------------------------------------------------------------

#define LOCAL_SIZE 8
#define ENVIRONMENT_MAP_SIZE 128
#define SH_INTERMEDIATE_SIZE (ENVIRONMENT_MAP_SIZE / LOCAL_SIZE)
#define CUBEMAP_MIP_LEVEL 2.0
#define POS_X 0
#define NEG_X 1
#define POS_Y 2
#define NEG_Y 3
#define POS_Z 4
#define NEG_Z 5

// ------------------------------------------------------------------
// INPUTS -----------------------------------------------------------
// ------------------------------------------------------------------

layout(local_size_x = LOCAL_SIZE, local_size_y = LOCAL_SIZE, local_size_z = 1) in;

// ------------------------------------------------------------------
// OUTPUTS ----------------------------------------------------------
// ------------------------------------------------------------------

layout(binding = 0, rgba32f) uniform image2DArray i_Cubemap;

// ------------------------------------------------------------------
// SAMPLERS ---------------------------------------------------------
// ------------------------------------------------------------------

uniform samplerCube s_Cubemap;
uniform float       u_Width;
uniform float       u_Height;

// ------------------------------------------------------------------
// STRUCTURES -------------------------------------------------------
// ------------------------------------------------------------------

struct SH9
{
    float c[9];
};

// ------------------------------------------------------------------

struct SH9Color
{
    vec3 c[9];
};

// ------------------------------------------------------------------
// FUNCTIONS --------------------------------------------------------
// ------------------------------------------------------------------

float area_integral(float x, float y)
{
    return atan(x * y, sqrt(x * x + y * y + 1));
}

// ------------------------------------------------------------------

float unlerp(float val, float max_val)
{
    return (val + 0.5) / max_val;
}

// ------------------------------------------------------------------

void project_onto_sh9(in vec3 dir, inout SH9 sh)
{
    // Band 0
    sh.c[0] = 0.282095;

    // Band 1
    sh.c[1] = -0.488603 * dir.y;
    sh.c[2] = 0.488603 * dir.z;
    sh.c[3] = -0.488603 * dir.x;

    // Band 2
    sh.c[4] = 1.092548 * dir.x * dir.y;
    sh.c[5] = -1.092548 * dir.y * dir.z;
    sh.c[6] = 0.315392 * (3.0 * dir.z * dir.z - 1.0);
    sh.c[7] = -1.092548 * dir.x * dir.z;
    sh.c[8] = 0.546274 * (dir.x * dir.x - dir.y * dir.y);
}

// ------------------------------------------------------------------

float calculate_solid_angle(uint x, uint y)
{
    float s = unlerp(float(x), u_Width) * 2.0 - 1.0;
    float t = unlerp(float(y), u_Height) * 2.0 - 1.0;

    // assumes square face
    float half_texel_size = 1.0 / u_Width;
    float x0              = s - half_texel_size;
    float y0              = t - half_texel_size;
    float x1              = s + half_texel_size;
    float y1              = t + half_texel_size;

    return area_integral(x0, y0) - area_integral(x0, y1) - area_integral(x1, y0) + area_integral(x1, y1);
}

// ------------------------------------------------------------------

vec3 calculate_direction(uint face, uint face_x, uint face_y)
{
    float s = unlerp(float(face_x), u_Width) * 2.0 - 1.0;
    float t = unlerp(float(face_y), u_Height) * 2.0 - 1.0;
    float x, y, z;

    switch (face)
    {
        case POS_Z:
            x = s;
            y = -t;
            z = 1;
            break;
        case NEG_Z:
            x = -s;
            y = -t;
            z = -1;
            break;
        case NEG_X:
            x = -1;
            y = -t;
            z = s;
            break;
        case POS_X:
            x = 1;
            y = -t;
            z = -s;
            break;
        case POS_Y:
            x = s;
            y = 1;
            z = t;
            break;
        case NEG_Y:
            x = s;
            y = -1;
            z = -t;
            break;
    }

    vec3  d;
    float inv_len = 1.0 / sqrt(x * x + y * y + z * z);
    d.x           = x * inv_len;
    d.y           = y * inv_len;
    d.z           = z * inv_len;

    return d;
}

// ------------------------------------------------------------------
// SHARED -----------------------------------------------------------
// ------------------------------------------------------------------

shared SH9Color g_sh_coeffs[LOCAL_SIZE][LOCAL_SIZE];
shared float    g_weights[LOCAL_SIZE][LOCAL_SIZE];

// ------------------------------------------------------------------
// MAIN -------------------------------------------------------------
// ------------------------------------------------------------------

void main()
{
    // Initialize shared memory
    for (int i = 0; i < 9; i++)
        g_sh_coeffs[gl_LocalInvocationID.x][gl_LocalInvocationID.y].c[i] = vec3(0.0);

    barrier();

    // Generate spherical harmonics basis
    SH9 basis;

    vec3  dir         = calculate_direction(gl_GlobalInvocationID.z, gl_GlobalInvocationID.x, gl_GlobalInvocationID.y);
    float solid_angle = calculate_solid_angle(gl_GlobalInvocationID.x, gl_GlobalInvocationID.y);
    vec3  texel       = textureLod(s_Cubemap, dir, CUBEMAP_MIP_LEVEL).rgb;

    project_onto_sh9(dir, basis);

    g_weights[gl_LocalInvocationID.x][gl_LocalInvocationID.y] = solid_angle;

    for (int i = 0; i < 9; i++)
        g_sh_coeffs[gl_LocalInvocationID.x][gl_LocalInvocationID.y].c[i] += texel * basis.c[i] * solid_angle;

    barrier();

    // Add up the coefficients and weights along the X axis.
    if (gl_LocalInvocationID.x == 0)
    {
        for (int shared_idx = 1; shared_idx < LOCAL_SIZE; shared_idx++)
        {
            g_weights[0][gl_LocalInvocationID.y] += g_weights[shared_idx][gl_LocalInvocationID.y];

            for (int coef_idx = 0; coef_idx < 9; coef_idx++)
                g_sh_coeffs[0][gl_LocalInvocationID.y].c[coef_idx] += g_sh_coeffs[shared_idx][gl_LocalInvocationID.y].c[coef_idx];
        }
    }

    barrier();

    // Add up the coefficients and weights along the Y axis.
    if (gl_LocalInvocationID.x == 0 && gl_LocalInvocationID.y == 0)
    {
        for (int shared_idx = 1; shared_idx < LOCAL_SIZE; shared_idx++)
        {
            g_weights[0][0] += g_weights[0][shared_idx];

            for (int coef_idx = 0; coef_idx < 9; coef_idx++)
                g_sh_coeffs[0][0].c[coef_idx] += g_sh_coeffs[0][shared_idx].c[coef_idx];
        }

        // Write out the SH9 coefficients.
        for (int coef_idx = 0; coef_idx < 9; coef_idx++)
        {
            ivec3 p = ivec3((SH_INTERMEDIATE_SIZE * coef_idx) + (gl_GlobalInvocationID.x / LOCAL_SIZE), gl_GlobalInvocationID.y / LOCAL_SIZE, gl_GlobalInvocationID.z);
            imageStore(i_Cubemap, p, vec4(g_sh_coeffs[0][0].c[coef_idx], g_weights[0][0]));
        }
    }
}

// ------------------------------------------------------------------
)";

static const char* g_cs_add_src = R"(
// ------------------------------------------------------------------
// CONSTANTS ---------------------------------------------------------
// ------------------------------------------------------------------

#define LOCAL_SIZE 8
#define ENVIRONMENT_MAP_SIZE 128
#define SH_INTERMEDIATE_SIZE 16
#define NUM_CUBEMAP_FACES 6

const float Pi = 3.141592654;

// ------------------------------------------------------------------
// INPUTS -----------------------------------------------------------
// ------------------------------------------------------------------

layout(local_size_x = 1, local_size_y = SH_INTERMEDIATE_SIZE, local_size_z = NUM_CUBEMAP_FACES) in;

// ------------------------------------------------------------------
// OUTPUTS ----------------------------------------------------------
// ------------------------------------------------------------------

layout(binding = 0, rgba32f) uniform image2D i_SH;

// ------------------------------------------------------------------
// SAMPLERS ---------------------------------------------------------
// ------------------------------------------------------------------

uniform sampler2DArray s_SHIntermediate;

// ------------------------------------------------------------------
// SHARED -----------------------------------------------------------
// ------------------------------------------------------------------

shared vec3  g_sh_coeffs[SH_INTERMEDIATE_SIZE][NUM_CUBEMAP_FACES];
shared float g_weights[SH_INTERMEDIATE_SIZE][NUM_CUBEMAP_FACES];

// ------------------------------------------------------------------
// MAIN -------------------------------------------------------------
// ------------------------------------------------------------------

void main()
{
    g_sh_coeffs[gl_GlobalInvocationID.y][gl_GlobalInvocationID.z] = vec3(0.0);
    g_weights[gl_GlobalInvocationID.y][gl_GlobalInvocationID.z]   = 0.0;

    barrier();

    // Add up coefficients along X axis.
    for (uint i = 0; i < SH_INTERMEDIATE_SIZE; i++)
    {
        ivec3 p   = ivec3(gl_GlobalInvocationID.x * SH_INTERMEDIATE_SIZE + i, gl_GlobalInvocationID.y, gl_GlobalInvocationID.z);
        vec4  val = texelFetch(s_SHIntermediate, p, 0);

        g_sh_coeffs[gl_GlobalInvocationID.y][gl_GlobalInvocationID.z] += val.rgb;
        g_weights[gl_GlobalInvocationID.y][gl_GlobalInvocationID.z] += val.a;
    }

    barrier();

    if (gl_GlobalInvocationID.z == 0)
    {
        // Add up coefficients along Z axis.
        for (uint i = 1; i < NUM_CUBEMAP_FACES; i++)
        {
            g_sh_coeffs[gl_GlobalInvocationID.y][0] += g_sh_coeffs[gl_GlobalInvocationID.y][i];
            g_weights[gl_GlobalInvocationID.y][0] += g_weights[gl_GlobalInvocationID.y][i];
        }
    }

    barrier();

    if (gl_GlobalInvocationID.y == 0 && gl_GlobalInvocationID.z == 0)
    {
        // Add up coefficients along Y axis.
        for (uint i = 1; i < SH_INTERMEDIATE_SIZE; i++)
        {
            g_sh_coeffs[0][0] += g_sh_coeffs[i][0];
            g_weights[0][0] += g_weights[i][0];
        }

        float scale = (4.0 * Pi) / g_weights[0][0];

        // Write out the coefficents.
        imageStore(i_SH, ivec2(gl_GlobalInvocationID.x, 0), vec4(g_sh_coeffs[0][0] * scale, g_weights[0][0]));
    }
}

// ------------------------------------------------------------------
)";
#endif

// -----------------------------------------------------------------------------------------------------------------------------------

CubemapSHProjection::CubemapSHProjection(
#if defined(DWSF_VULKAN)
    vk::Backend::Ptr backend,
    vk::Image::Ptr   cubemap
#else
    gl::TextureCube::Ptr cubemap
#endif
    )
#if !defined(DWSF_VULKAN)
    :
    m_cubemap(cubemap)
#endif
{
#if defined(DWSF_VULKAN)
    m_size = float(cubemap->width()) / 4.0f;

    // Create descriptor set layout

    vk::DescriptorSetLayout::Desc ds_layout_desc;

    ds_layout_desc.add_binding(0, VK_DESCRIPTOR_TYPE_STORAGE_IMAGE, 1, VK_SHADER_STAGE_COMPUTE_BIT);
    ds_layout_desc.add_binding(1, VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER, 1, VK_SHADER_STAGE_COMPUTE_BIT);

    m_ds_layout = vk::DescriptorSetLayout::create(backend, ds_layout_desc);

    // Allocate descriptor sets

    m_projection_ds = backend->allocate_descriptor_set(m_ds_layout);
    m_add_ds        = backend->allocate_descriptor_set(m_ds_layout);

    // Create images and image views

    m_cubemap_image_view = vk::ImageView::create(backend, cubemap, VK_IMAGE_VIEW_TYPE_CUBE, VK_IMAGE_ASPECT_COLOR_BIT, 0, cubemap->mip_levels(), 0, 6);
    m_cubemap_image_view->set_name("SH Cubemap");

    m_image = vk::Image::create(backend, VK_IMAGE_TYPE_2D, 9, 1, 1, 1, 1, VK_FORMAT_R32G32B32A32_SFLOAT, VMA_MEMORY_USAGE_GPU_ONLY, VK_IMAGE_USAGE_SAMPLED_BIT | VK_IMAGE_USAGE_STORAGE_BIT, VK_SAMPLE_COUNT_1_BIT, VK_IMAGE_LAYOUT_UNDEFINED);
    m_image->set_name("SH Projection Image");

    m_image_view = vk::ImageView::create(backend, m_image, VK_IMAGE_VIEW_TYPE_2D, VK_IMAGE_ASPECT_COLOR_BIT, 0, 1, 0, 1);
    m_image_view->set_name("SH Projection Image View");

    m_intermediate_image = vk::Image::create(backend, VK_IMAGE_TYPE_2D, SH_INTERMEDIATE_SIZE * 9, SH_INTERMEDIATE_SIZE, 1, 1, 6, VK_FORMAT_R32G32B32A32_SFLOAT, VMA_MEMORY_USAGE_GPU_ONLY, VK_IMAGE_USAGE_SAMPLED_BIT | VK_IMAGE_USAGE_STORAGE_BIT, VK_SAMPLE_COUNT_1_BIT, VK_IMAGE_LAYOUT_UNDEFINED);
    m_intermediate_image->set_name("SH Projection Intermediate Image");

    m_intermediate_image_view = vk::ImageView::create(backend, m_intermediate_image, VK_IMAGE_VIEW_TYPE_2D_ARRAY, VK_IMAGE_ASPECT_COLOR_BIT, 0, 1, 0, 6);
    m_intermediate_image_view->set_name("SH Projection Intermediate Image View");

    // Update descriptor sets

    VkWriteDescriptorSet write_data[4];
    DW_ZERO_MEMORY(write_data[0]);
    DW_ZERO_MEMORY(write_data[1]);
    DW_ZERO_MEMORY(write_data[2]);
    DW_ZERO_MEMORY(write_data[3]);

    VkDescriptorImageInfo write_intermediate_image;

    write_intermediate_image.sampler     = VK_NULL_HANDLE;
    write_intermediate_image.imageView   = m_intermediate_image_view->handle();
    write_intermediate_image.imageLayout = VK_IMAGE_LAYOUT_GENERAL;

    VkDescriptorImageInfo sh_image;

    sh_image.sampler     = VK_NULL_HANDLE;
    sh_image.imageView   = m_image_view->handle();
    sh_image.imageLayout = VK_IMAGE_LAYOUT_GENERAL;

    VkDescriptorImageInfo cubemap_image;

    cubemap_image.sampler     = backend->nearest_sampler()->handle();
    cubemap_image.imageView   = m_cubemap_image_view->handle();
    cubemap_image.imageLayout = VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL;

    VkDescriptorImageInfo read_intermediate_image;

    read_intermediate_image.sampler     = backend->nearest_sampler()->handle();
    read_intermediate_image.imageView   = m_intermediate_image_view->handle();
    read_intermediate_image.imageLayout = VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL;

    write_data[0].sType           = VK_STRUCTURE_TYPE_WRITE_DESCRIPTOR_SET;
    write_data[0].descriptorCount = 1;
    write_data[0].descriptorType  = VK_DESCRIPTOR_TYPE_STORAGE_IMAGE;
    write_data[0].pImageInfo      = &write_intermediate_image;
    write_data[0].dstBinding      = 0;
    write_data[0].dstSet          = m_projection_ds->handle();

    write_data[1].sType           = VK_STRUCTURE_TYPE_WRITE_DESCRIPTOR_SET;
    write_data[1].descriptorCount = 1;
    write_data[1].descriptorType  = VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER;
    write_data[1].pImageInfo      = &cubemap_image;
    write_data[1].dstBinding      = 1;
    write_data[1].dstSet          = m_projection_ds->handle();

    write_data[2].sType           = VK_STRUCTURE_TYPE_WRITE_DESCRIPTOR_SET;
    write_data[2].descriptorCount = 1;
    write_data[2].descriptorType  = VK_DESCRIPTOR_TYPE_STORAGE_IMAGE;
    write_data[2].pImageInfo      = &sh_image;
    write_data[2].dstBinding      = 0;
    write_data[2].dstSet          = m_add_ds->handle();

    write_data[3].sType           = VK_STRUCTURE_TYPE_WRITE_DESCRIPTOR_SET;
    write_data[3].descriptorCount = 1;
    write_data[3].descriptorType  = VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER;
    write_data[3].pImageInfo      = &read_intermediate_image;
    write_data[3].dstBinding      = 1;
    write_data[3].dstSet          = m_add_ds->handle();

    vkUpdateDescriptorSets(backend->device(), 4, write_data, 0, nullptr);

    // Pipeline Layouts

    vk::PipelineLayout::Desc projection_desc;

    projection_desc.add_descriptor_set_layout(m_ds_layout);
    projection_desc.add_push_constant_range(VK_SHADER_STAGE_COMPUTE_BIT, 0, sizeof(float));

    m_projection_pipeline_layout = dw::vk::PipelineLayout::create(backend, projection_desc);

    vk::PipelineLayout::Desc add_desc;

    add_desc.add_descriptor_set_layout(m_ds_layout);

    m_add_pipeline_layout = dw::vk::PipelineLayout::create(backend, add_desc);

    // Load shader modules

    std::vector<char> projection_spirv;

    projection_spirv.resize(kSH_PROJECTION_SPIRV_size);
    memcpy(&projection_spirv[0], &kSH_PROJECTION_SPIRV_data[0], kSH_PROJECTION_SPIRV_size);

    std::vector<char> add_spirv;

    add_spirv.resize(kSH_ADD_SPIRV_size);
    memcpy(&add_spirv[0], &kSH_ADD_SPIRV_data[0], kSH_ADD_SPIRV_size);

    vk::ShaderModule::Ptr projection_module = dw::vk::ShaderModule::create(backend, projection_spirv);
    vk::ShaderModule::Ptr add_module        = dw::vk::ShaderModule::create(backend, add_spirv);

    // Create pipeline

    vk::ComputePipeline::Desc projection_comp_desc;

    projection_comp_desc.set_pipeline_layout(m_projection_pipeline_layout);
    projection_comp_desc.set_shader_stage(projection_module, "main");

    m_projection_pipeline = dw::vk::ComputePipeline::create(backend, projection_comp_desc);

    vk::ComputePipeline::Desc add_comp_desc;

    add_comp_desc.set_pipeline_layout(m_add_pipeline_layout);
    add_comp_desc.set_shader_stage(add_module, "main");

    m_add_pipeline = dw::vk::ComputePipeline::create(backend, add_comp_desc);
#else
    m_texture_intermediate = gl::Texture2D::create(SH_INTERMEDIATE_SIZE * 9, SH_INTERMEDIATE_SIZE, 6, 1, 1, GL_RGBA32F, GL_RGBA, GL_FLOAT);
    m_texture              = gl::Texture2D::create(9, 1, 1, 1, 1, GL_RGBA32F, GL_RGBA, GL_FLOAT);

    m_texture_intermediate->set_min_filter(GL_NEAREST);
    m_texture_intermediate->set_mag_filter(GL_NEAREST);

    m_texture->set_min_filter(GL_NEAREST);
    m_texture->set_mag_filter(GL_NEAREST);

    {
        // Create general shaders
        m_projection_cs = gl::Shader::create(GL_COMPUTE_SHADER, g_cs_projection_src);

        if (!m_projection_cs->compiled())
            DW_LOG_FATAL("Failed to create Shaders");

        // Create general shader program
        m_projection_program = gl::Program::create({ m_projection_cs });

        if (!m_projection_program)
            DW_LOG_FATAL("Failed to create Shader Program");
    }

    {
        // Create general shaders
        m_add_cs = gl::Shader::create(GL_COMPUTE_SHADER, g_cs_add_src);

        if (!m_add_cs->compiled())
            DW_LOG_FATAL("Failed to create Shaders");

        // Create general shader program
        m_add_program = gl::Program::create({ m_add_cs });

        if (!m_add_program)
            DW_LOG_FATAL("Failed to create Shader Program");
    }
#endif
}

// -----------------------------------------------------------------------------------------------------------------------------------

CubemapSHProjection::~CubemapSHProjection()
{
#if defined(DWSF_VULKAN)
    m_cubemap_image_view.reset();
    m_image.reset();
    m_image_view.reset();
    m_intermediate_image.reset();
    m_intermediate_image_view.reset();
    m_projection_pipeline.reset();
    m_add_pipeline.reset();
    m_projection_pipeline_layout.reset();
    m_add_pipeline_layout.reset();
    m_ds_layout.reset();
    m_projection_ds.reset();
    m_add_ds.reset();
#else
    m_add_program.reset();
    m_projection_program.reset();
    m_cubemap.reset();
    m_texture.reset();
    m_texture_intermediate.reset();
    m_projection_cs.reset();
    m_add_cs.reset();
#endif
}

// -----------------------------------------------------------------------------------------------------------------------------------

void CubemapSHProjection::update(
#if defined(DWSF_VULKAN)
    vk::CommandBuffer::Ptr cmd_buf
#endif
)
{
#if defined(DWSF_VULKAN)
    VkImageSubresourceRange intermediate_subresource_range = { VK_IMAGE_ASPECT_COLOR_BIT, 0, 1, 0, 6 };

    dw::vk::utilities::set_image_layout(
        cmd_buf->handle(),
        m_intermediate_image->handle(),
        VK_IMAGE_LAYOUT_UNDEFINED,
        VK_IMAGE_LAYOUT_GENERAL,
        intermediate_subresource_range);

    vkCmdBindPipeline(cmd_buf->handle(), VK_PIPELINE_BIND_POINT_COMPUTE, m_projection_pipeline->handle());
    vkCmdPushConstants(cmd_buf->handle(), m_projection_pipeline_layout->handle(), VK_SHADER_STAGE_COMPUTE_BIT, 0, sizeof(float), &m_size);
    vkCmdBindDescriptorSets(cmd_buf->handle(), VK_PIPELINE_BIND_POINT_COMPUTE, m_projection_pipeline_layout->handle(), 0, 1, &m_projection_ds->handle(), 0, nullptr);

    vkCmdDispatch(cmd_buf->handle(), IRRADIANCE_CUBEMAP_SIZE / IRRADIANCE_WORK_GROUP_SIZE, IRRADIANCE_CUBEMAP_SIZE / IRRADIANCE_WORK_GROUP_SIZE, 6);

    dw::vk::utilities::set_image_layout(
        cmd_buf->handle(),
        m_intermediate_image->handle(),
        VK_IMAGE_LAYOUT_GENERAL,
        VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL,
        intermediate_subresource_range);

    VkImageSubresourceRange sh_subresource_range = { VK_IMAGE_ASPECT_COLOR_BIT, 0, 1, 0, 1 };

    dw::vk::utilities::set_image_layout(
        cmd_buf->handle(),
        m_image->handle(),
        VK_IMAGE_LAYOUT_UNDEFINED,
        VK_IMAGE_LAYOUT_GENERAL,
        sh_subresource_range);

    vkCmdBindPipeline(cmd_buf->handle(), VK_PIPELINE_BIND_POINT_COMPUTE, m_add_pipeline->handle());
    vkCmdBindDescriptorSets(cmd_buf->handle(), VK_PIPELINE_BIND_POINT_COMPUTE, m_add_pipeline_layout->handle(), 0, 1, &m_add_ds->handle(), 0, nullptr);

    vkCmdDispatch(cmd_buf->handle(), 9, 1, 1);

    dw::vk::utilities::set_image_layout(
        cmd_buf->handle(),
        m_image->handle(),
        VK_IMAGE_LAYOUT_GENERAL,
        VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL,
        sh_subresource_range);
#else
    m_projection_program->use();

    m_projection_program->set_uniform("u_Width", (float)m_cubemap->width() / 4.0f);
    m_projection_program->set_uniform("u_Height", (float)m_cubemap->height() / 4.0f);

    if (m_projection_program->set_uniform("s_Cubemap", 1))
        m_cubemap->bind(1);

    m_texture_intermediate->bind_image(0, 0, 0, GL_WRITE_ONLY, GL_RGBA32F);

    glDispatchCompute(IRRADIANCE_CUBEMAP_SIZE / IRRADIANCE_WORK_GROUP_SIZE, IRRADIANCE_CUBEMAP_SIZE / IRRADIANCE_WORK_GROUP_SIZE, 6);

    glMemoryBarrier(GL_SHADER_STORAGE_BARRIER_BIT);

    m_add_program->use();

    m_texture->bind_image(0, 0, 0, GL_WRITE_ONLY, GL_RGBA32F);

    if (m_add_program->set_uniform("s_SHIntermediate", 1))
        m_texture_intermediate->bind(1);

    glDispatchCompute(9, 1, 1);

    glMemoryBarrier(GL_SHADER_STORAGE_BARRIER_BIT);
#endif
}

// -----------------------------------------------------------------------------------------------------------------------------------
} // namespace dw